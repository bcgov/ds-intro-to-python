<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Data Science using Python - 5&nbsp; Cleaning Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./21_exploring_data_structures.html" rel="next">
<link href="./11_getting_data_with_pandas.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./BCID_H_rgb_rev.png" alt="" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-introduction-to-python" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Introduction to Python</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-introduction-to-python">    
        <li>
    <a class="dropdown-item" href="./00_introduction_to_python.html">
 <span class="dropdown-text">Getting Up and Running</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./13_working_with_code.html">
 <span class="dropdown-text">Working with Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_core_data_structure_concepts.html">
 <span class="dropdown-text">Core Concepts</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-get-and-clean-data" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Get and Clean Data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-get-and-clean-data">    
        <li>
    <a class="dropdown-item" href="./11_getting_data_with_pandas.html">
 <span class="dropdown-text">Getting Data with Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./22_cleaning_it_up.html">
 <span class="dropdown-text">Cleaning Data with Pandas</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-understand-and-analyze-data" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Understand and Analyze Data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-understand-and-analyze-data">    
        <li>
    <a class="dropdown-item" href="./21_exploring_data_structures.html">
 <span class="dropdown-text">Exploring Data Structures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./22_graphical_depictions_of_data.html">
 <span class="dropdown-text">Graphical Depictions of Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-advanced-topics" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Advanced Topics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-advanced-topics">    
        <li>
    <a class="dropdown-item" href="./30_bcdata.html">
 <span class="dropdown-text">bcdata package</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./31_advanced_pandas.html">
 <span class="dropdown-text">Advanced Pandas</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./references.html">
 <span class="menu-text">References</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bcgov/ds-intro-to-python"><i class="bi bi-github" role="img" aria-label="Source Code">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown  compact">
    <a class="nav-link dropdown-toggle" href="#" id="" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-share" role="img" aria-label="Share">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="">    
        <li>
    <a class="dropdown-item" href="https://twitter.com/intent/tweet?url=|url|"><i class="bi bi-twitter" role="img">
</i> 
 <span class="dropdown-text">Twitter</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|"><i class="bi bi-facebook" role="img">
</i> 
 <span class="dropdown-text">Facebook</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Cleaning Data</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./cover.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_introduction_to_python.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Up and Running</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_working_with_code.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Working with Code</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_core_data_structure_concepts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Core Concepts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_getting_data_with_pandas.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Getting Data With Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_cleaning_it_up.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Cleaning Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_exploring_data_structures.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Exploring Data Structures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_graphical_depictions_of_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Graphical Depictions of Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30_bcdata.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to bcdata</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31_advanced_pandas.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Advanced Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cleaning-and-data-science" id="toc-cleaning-and-data-science" class="nav-link active" data-scroll-target="#cleaning-and-data-science"><span class="toc-section-number">5.1</span>  Cleaning and data science</a></li>
  <li><a href="#dealing-with-missing-data" id="toc-dealing-with-missing-data" class="nav-link" data-scroll-target="#dealing-with-missing-data"><span class="toc-section-number">5.2</span>  Dealing with Missing Data</a>
  <ul>
  <li><a href="#locating-missing-data" id="toc-locating-missing-data" class="nav-link" data-scroll-target="#locating-missing-data">Locating Missing Data</a></li>
  <li><a href="#dropping-rows-and-columns" id="toc-dropping-rows-and-columns" class="nav-link" data-scroll-target="#dropping-rows-and-columns">Dropping rows and columns</a></li>
  <li><a href="#saving-the-dataframe-inplace" id="toc-saving-the-dataframe-inplace" class="nav-link" data-scroll-target="#saving-the-dataframe-inplace">Saving the dataframe “inplace”</a></li>
  <li><a href="#filling-in-missing-data" id="toc-filling-in-missing-data" class="nav-link" data-scroll-target="#filling-in-missing-data">Filling in missing data</a></li>
  </ul></li>
  <li><a href="#modifying-existing-data" id="toc-modifying-existing-data" class="nav-link" data-scroll-target="#modifying-existing-data"><span class="toc-section-number">5.3</span>  Modifying existing data</a>
  <ul>
  <li><a href="#cleaning-the-header-row" id="toc-cleaning-the-header-row" class="nav-link" data-scroll-target="#cleaning-the-header-row">Cleaning the header row</a></li>
  <li><a href="#ensuring-the-right-datatypes" id="toc-ensuring-the-right-datatypes" class="nav-link" data-scroll-target="#ensuring-the-right-datatypes">Ensuring the right datatypes</a></li>
  <li><a href="#recoding-values" id="toc-recoding-values" class="nav-link" data-scroll-target="#recoding-values">Recoding values</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/bcgov/ds-intro-to-python/blob/main/22_cleaning_it_up.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/bcgov/ds-intro-to-python/edit/main/22_cleaning_it_up.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/bcgov/ds-intro-to-python/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Cleaning Data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="cleaning-and-data-science" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="cleaning-and-data-science"><span class="header-section-number">5.1</span> Cleaning and data science</h2>
<p>Imagine you have finally gotten that dataset that you need to work with to answer those questions you’ve been asked to clear up. But wait! Before you get started in earnest working away with generating insights, it is important that you take a closer look at the “quality” of the data.</p>
<p>There is much to look at and consider when it comes to the topic of data cleaning. You probably have heard it said that 80% (or some high percentage) of a data scientist’s time is spent cleaning data, that is, putting it in a form that will better suit its downstream uses.</p>
<p>Not surprisingly, data cleaning is a topic difficult to cover systematically in an introductory course.</p>
<center>
<img src="images/cleaning-it-up/73mtqx.gif" width="35%" style="margin:auto">
<p style="text-align: center">
It’s not so bad, promise!
</p>
</center>
<p>So in this tutorial we will focus on a few cleaning techniques - with pandas - that are likely going to be leveraged over and over again when you work with data in python.</p>
<ul>
<li>How to identify and clean up missing data</li>
<li>When and how to change datatypes</li>
<li>When and how to modify values in your dataset</li>
</ul>
</section>
<section id="dealing-with-missing-data" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="dealing-with-missing-data"><span class="header-section-number">5.2</span> Dealing with Missing Data</h2>
<p>One of the most common issues in data cleaning has to do with data that is missing from your dataset. Most data, even data that is meticulously collected and managed, is likely to have empty cells. Empty data can be harmless, or it can represent a challenge to you, depending on what you need your data to do once you have finished working with it.</p>
<p>The best way to learn about these concepts is to see them in action with real (or real-ish) data! Before we get started with fetching the data, let’s go ahead and get pandas for today’s session.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import pandas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, imagine we had our own online streaming service. We have access to some data that will help us predict what our users would like to see. To fetch it, run the code below:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mr <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span> \</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ds-intro-to-python/main/data/movieratings.csv"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> pd.read_csv(mr)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Floriana</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Raymundo</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jung</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kumar</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Maria</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>This is a 10 row dataframe, with each row containing a movie rater as well as their ratings for selected movies that they have given ratings for. For interpretative purposes, each movie is rated on a 5 point scale, with 5 being super awesome and 1 being dismal. Not every movie is rated by every rater, so several cells are blank. These are the missing data cells and are marked with “NaN”, indicating missing data.</p>
<p>This dataset, while small and made up, exemplifies a classic “recommendation engine” use case problem - there are lots of raters and lots of movies, but an <em>awful lot</em> of missing data. So what one chooses to do with missing data is a key cleaning question.</p>
<section id="locating-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="locating-missing-data">Locating Missing Data</h3>
<p>In pandas, there is a widely used method named <code>isna()</code> which can be applied to a whole dataframe or just to a particular series or column.</p>
<p>Below we apply it to the entire dataframe to get a cell by cell view of whether the cell data is missing or not (True means it is missing, False means it is not):</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find the missing values</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>It is probably helpful to note there is a similar function called <code>isnull()</code> that is an alias for <code>isna()</code>. You may run into both, and both will return the same results. There is also a <code>notna()</code>(<code>notnull()</code>) function, which is the inverse function of <code>isna()</code>(<code>isnull()</code>), returning True for values that are not NA. For simplicity, let’s just stick with <code>isna()</code> in this tutorial.</p>
<p>To get a better summary overview (i.e.&nbsp;one that summarizes with numbers) of how many missing values there are per column, then we need to chain togther a <code>.sum()</code> function to the line of code like so:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">###listing out the missing values in the dataframe for each series</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Rater           0
Star Wars       2
Finding Nemo    5
Forrest Gump    3
Parasite        4
Citizen Kane    4
dtype: int64</code></pre>
</div>
</div>
<p>The reason that this works is because a boolean value of True is represented in pandas by the value of 1, while False is represented by a 0. Therefore, we can apply the <code>sum()</code>method to the dataframe with series being returned that contains the counts of missing items in each column.</p>
<p>Now we see no missing data for Rater, but missing data for each of the movies. For our use case, missing data is a real challenge. With pandas, we can deal with this in many different ways.</p>
</section>
<section id="dropping-rows-and-columns" class="level3">
<h3 class="anchored" data-anchor-id="dropping-rows-and-columns">Dropping rows and columns</h3>
<p>One cleaning option we have is to drop entire rows or columns with missing values in them from the dataframe. The method is called <code>dropna()</code>and takes a number of parameters:</p>
<ul>
<li>axis: {0 or ‘index’, 1 or ‘columns’}, default 0</li>
<li>how: {‘any’, ‘all’}, default ‘any’</li>
<li>subset: column label or sequence of labels</li>
</ul>
<p>Imagine we would like to drop all of the rows with any missing values in them. Since the <code>axis=0</code> and <code>how=any</code> parameters are the defaults, we can write an elegant and simple line of code:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>reduced_rows <span class="op">=</span> movie_ratings.dropna()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>reduced_rows.head(<span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>Arthur</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Martina</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Orson</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We still have three raters who have given us ratings for each movie. The dataset is nice and clean now, although it has come at a pretty big cost, losing seven rows of data! If we go in the other direction, and insert a parameter of <code>how='all'</code>, then we have the opposite problem, with <em>no rows</em> being eliminated (as there were no instances where all of the columns contained missing data for a given row)!</p>
<p>Another option is to use subset to eliminate rows on the basis of whether values are missing in a specified subset. Let’s say we want to have just the rows of data where there is not missing ratings data for the film “Parasite”. We would use <code>subset=</code> parameter and identify the column we want to clean up:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>par_df <span class="op">=</span> movie_ratings.dropna(subset<span class="op">=</span><span class="st">'Parasite'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>par_df.head(<span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Floriana</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jung</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Arthur</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Marcellus</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Martina</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Orson</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We can see that, while there is no NaN in the Parasite column, we can see they are still there sprinkled throughout other columns.</p>
<p>Now what would happen if we applied that same drop logic to all columns?</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>reduced_cols <span class="op">=</span> movie_ratings.dropna(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>reduced_cols.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Floriana</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Raymundo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jung</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kumar</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Maria</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We see that we pretty much all the movie columns have been removed, as each of these columns had at least one missing value! So be careful when using <code>dropna()</code> as it can be a powerful eraser of data. Whether you should use it or how you should will depend on the downstream uses for your data.</p>
<p><br></p>
</section>
<section id="saving-the-dataframe-inplace" class="level3">
<h3 class="anchored" data-anchor-id="saving-the-dataframe-inplace">Saving the dataframe “inplace”</h3>
<p><code>Inplace</code> is an argument used in different functions such as <code>dropna()</code> that we have just looked at. The default value of this attribute is <code>False</code>, which means whatever the function does to the dataframe, it does so as a <em>copy</em> of the object. When the argument is <code>inplace=True</code>, however, whatever changes are made by the given function are made to the original object <em>inplace</em>, not just to a copy of it!</p>
<p>Let’s look at how this works starting with fetching the data from the source:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetching the data to make sure we start again with the original</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mr <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span> \</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ds-intro-to-python/main/data/movieratings.csv"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> pd.read_csv(mr)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Floriana</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Raymundo</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jung</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kumar</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Maria</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now let’s “modify” the frame with <code>inplace=False</code> with the code below and see what happens:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making change to dataframe with inplace=False</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.dropna(how<span class="op">=</span><span class="st">'any'</span>, inplace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Looking at the dataframe</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Floriana</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Raymundo</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jung</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kumar</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Maria</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Ok, it kind of looks like “nothing happened”! And in a way, with the code we ran, nothing did happen, as the result was not assigned to a new object. Soooo, what’s the point of that? Any guesses?</p>
<p>When we run exactly the same code except with the parameter <code>inplace</code> set to <code>'True'</code>, the dropped data is actually gone!</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making change to dataframe with inplace=False</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.dropna(how<span class="op">=</span><span class="st">'any'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Looking at the dataframe</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>Arthur</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Martina</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Orson</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>So now if we want to work with the “movie_ratings” object without the columns we just dropped, we would have to go back and rerun the <code>read_csv()</code> function and fetch the original data again! It is therefore important when writing your cleaning code that you use this parameter carefully.</p>
</section>
<section id="filling-in-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="filling-in-missing-data">Filling in missing data</h3>
<p>Sometimes it is the right cleaning decision to <em>fill in</em> missing data with some values.</p>
<p>Take the example of our movie ratings dataframe. The basic way to fill in missing values would you to specify a value to take the place of each missing value. One approach is to calculate and plug in the mean value - which we know to be (3.85) for the entire dataframe:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetching the data, yet again, to make sure we start again with the original</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mr <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span> \</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ds-intro-to-python/main/data/movieratings.csv"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> pd.read_csv(mr)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># using fillna and a passing in a constant</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>filled_385 <span class="op">=</span> movie_ratings.fillna(<span class="fl">3.85</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>filled_385.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Floriana</td>
      <td>3.85</td>
      <td>5.00</td>
      <td>5.00</td>
      <td>3.00</td>
      <td>3.85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Raymundo</td>
      <td>4.00</td>
      <td>3.85</td>
      <td>3.85</td>
      <td>3.85</td>
      <td>5.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jung</td>
      <td>5.00</td>
      <td>3.85</td>
      <td>3.85</td>
      <td>5.00</td>
      <td>3.85</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kumar</td>
      <td>5.00</td>
      <td>3.85</td>
      <td>4.00</td>
      <td>3.85</td>
      <td>4.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Maria</td>
      <td>5.00</td>
      <td>4.00</td>
      <td>5.00</td>
      <td>3.85</td>
      <td>3.85</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Arthur</td>
      <td>2.00</td>
      <td>2.00</td>
      <td>3.00</td>
      <td>3.00</td>
      <td>3.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Marcellus</td>
      <td>3.85</td>
      <td>3.85</td>
      <td>4.00</td>
      <td>5.00</td>
      <td>4.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Martina</td>
      <td>5.00</td>
      <td>5.00</td>
      <td>5.00</td>
      <td>5.00</td>
      <td>5.00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Orson</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>2.00</td>
      <td>5.00</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Luke</td>
      <td>5.00</td>
      <td>3.85</td>
      <td>3.85</td>
      <td>3.85</td>
      <td>3.85</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Ok, that’s good. Good, but not great for our use case! Maybe we could avail ourselves to some options within the <code>method=</code> parameter with the parentheses the <code>fillna()</code> function. With a specification of <code>bfill</code> we can fill a NaN value with the preceding valid value in that column. <code>ffill</code> fills with the value after it.</p>
<p>What would that look like for our dataset?</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>bfilled_mr <span class="op">=</span> movie_ratings.fillna(method<span class="op">=</span><span class="st">'bfill'</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>bfilled_mr.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Floriana</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Raymundo</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jung</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kumar</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Maria</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Arthur</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Marcellus</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Martina</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Orson</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Luke</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Notice that the bottom row stays NaN when we use bfill. That’s because it can not find a value to backfill with for this row! Using forward fill creates the same issue for the first row. For our use case, admittedly <code>bfill</code> and <code>ffill</code> probably are sub-optimal solutions.</p>
<p>Since we have some ratings data already for each movie, one approach would be to fill in the missing data with the mean rating for that movie from the valid data.</p>
<p>Let’s try that approach on a single column. For the movie Parasite, we fill in the missing values for that column with the average value:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>movie_ratings[<span class="st">'Parasite'</span>] <span class="op">=</span> movie_ratings[<span class="st">'Parasite'</span>]. <span class="op">\</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  fillna(movie_ratings[<span class="st">'Parasite'</span>].mean())</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>movie_ratings.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Floriana</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>3.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Raymundo</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.833333</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jung</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kumar</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>3.833333</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Maria</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.833333</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Arthur</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Marcellus</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.000000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Martina</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.000000</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Orson</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.000000</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Luke</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.833333</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>And we can extend that for all numeric columns at once!</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> movie_ratings.fillna(movie_ratings.mean(numeric_only<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Rater</th>
      <th>Star Wars</th>
      <th>Finding Nemo</th>
      <th>Forrest Gump</th>
      <th>Parasite</th>
      <th>Citizen Kane</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Floriana</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.000000</td>
      <td>3.000000</td>
      <td>4.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Raymundo</td>
      <td>4.0</td>
      <td>3.4</td>
      <td>3.857143</td>
      <td>3.833333</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jung</td>
      <td>5.0</td>
      <td>3.4</td>
      <td>3.857143</td>
      <td>5.000000</td>
      <td>4.333333</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kumar</td>
      <td>5.0</td>
      <td>3.4</td>
      <td>4.000000</td>
      <td>3.833333</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Maria</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.000000</td>
      <td>3.833333</td>
      <td>4.333333</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Arthur</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Marcellus</td>
      <td>4.0</td>
      <td>3.4</td>
      <td>4.000000</td>
      <td>5.000000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Martina</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Orson</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Luke</td>
      <td>5.0</td>
      <td>3.4</td>
      <td>3.857143</td>
      <td>3.833333</td>
      <td>4.333333</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>While far from perfect, now we have some filled in data that has some reasonable chance of adding value.</p>
<p>Similar to <code>fillna()</code> is a method called <code>interpolate()</code>, which takes the average of the values near the missing values and plugs them in. To do this, we pass in the <code>interpolate()</code> in similar fashion to how we used <code>fillna()</code> above.</p>
<div class="callout-warning callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Challenge 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>You are given a dataset for several days time frame in April/May 2021 of the average daily temperature in celcius for three Canadian cities. You would like to ultimately create a plot of the temperatures but don’t want to have gaps in the data. Run the code below to get the data and see what it looks like.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>temps <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span> \</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ds-intro-to-python/main/data/citytemps.csv"</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>city_temps <span class="op">=</span> pd.read_csv(temps)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>city_temps.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Day</th>
      <th>Victoria</th>
      <th>Regina</th>
      <th>Sudbury</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>25-Feb-21</td>
      <td>15.0</td>
      <td>NaN</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26-Feb-21</td>
      <td>18.0</td>
      <td>-11.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>27-Feb-21</td>
      <td>NaN</td>
      <td>-6.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28-Feb-21</td>
      <td>12.0</td>
      <td>-2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>01-Mar-21</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>02-Mar-21</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>03-Mar-21</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>04-Mar-21</td>
      <td>15.0</td>
      <td>7.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>05-Mar-21</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>06-Mar-21</td>
      <td>11.0</td>
      <td>4.0</td>
      <td>14.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Unfortunately you notice that several of the days have data missing. Write code that leverages the interpolate() function to fill in the missing data. Run the code. Is this an appropriate solution for the problem? What are the pros and cons to this approach.</p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution to Challenge 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Code you would write is below.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>interpolate_temps <span class="op">=</span> city_temps.interpolate()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>interpolate_temps.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Day</th>
      <th>Victoria</th>
      <th>Regina</th>
      <th>Sudbury</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>25-Feb-21</td>
      <td>15.00</td>
      <td>NaN</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26-Feb-21</td>
      <td>18.00</td>
      <td>-11.00</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>27-Feb-21</td>
      <td>15.00</td>
      <td>-6.00</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28-Feb-21</td>
      <td>12.00</td>
      <td>-2.00</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>01-Mar-21</td>
      <td>12.75</td>
      <td>0.25</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>02-Mar-21</td>
      <td>13.50</td>
      <td>2.50</td>
      <td>10.5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>03-Mar-21</td>
      <td>14.25</td>
      <td>4.75</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>04-Mar-21</td>
      <td>15.00</td>
      <td>7.00</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>05-Mar-21</td>
      <td>13.00</td>
      <td>5.50</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>06-Mar-21</td>
      <td>11.00</td>
      <td>4.00</td>
      <td>14.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Here we can see how the values “smooth” out the data. Were we to go ahead and plot the data, it would make more sense.</p>
</div>
</div>
</div>
<p>Dealing with missing data is one normal task in cleaning, changing data and header content is another, let’s take a look at that next.</p>
</section>
</section>
<section id="modifying-existing-data" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="modifying-existing-data"><span class="header-section-number">5.3</span> Modifying existing data</h2>
<p>Now let’s grad a different dataset, this one is quite redacted snip of the 2014 Mental Health in Tech Survey https://www.kaggle.com/datasets/osmi/mental-health-in-tech-survey.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>techhealth <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span> \</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ds-intro-to-python/main/data/techhealth.csv"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>m_health <span class="op">=</span> pd.read_csv(techhealth)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>m_health.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Timestamp</th>
      <th>Age</th>
      <th>Gender</th>
      <th>Country</th>
      <th>self employed</th>
      <th>family history</th>
      <th>treatment</th>
      <th>work interfere</th>
      <th>remote work</th>
      <th>tech company</th>
      <th>benefits</th>
      <th>leave</th>
      <th>mental health consequence</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>27/08/2014 11:35</td>
      <td>46</td>
      <td>Male</td>
      <td>United States</td>
      <td>No</td>
      <td>No</td>
      <td>Yes</td>
      <td>Often</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>1</th>
      <td>27/08/2014 11:36</td>
      <td>41</td>
      <td>Male</td>
      <td>United States</td>
      <td>No</td>
      <td>No</td>
      <td>Yes</td>
      <td>Never</td>
      <td>No</td>
      <td>No</td>
      <td>Don't know</td>
      <td>Don't know</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>2</th>
      <td>27/08/2014 11:36</td>
      <td>33</td>
      <td>male</td>
      <td>United States</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Rarely</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>27/08/2014 11:37</td>
      <td>35</td>
      <td>male</td>
      <td>United States</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Sometimes</td>
      <td>No</td>
      <td>No</td>
      <td>Yes</td>
      <td>Very easy</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>4</th>
      <td>27/08/2014 11:42</td>
      <td>35</td>
      <td>M</td>
      <td>United States</td>
      <td>No</td>
      <td>No</td>
      <td>Yes</td>
      <td>Rarely</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Very easy</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><br> This abridged version of the dataset contains 24 cases and 13 variables:</p>
<ul>
<li>Timestamp</li>
<li>Age</li>
<li>Gender</li>
<li>Country</li>
<li>Self Employed: Are you self-employed?</li>
<li>Family History: Do you have a family history of mental illness?</li>
<li>Treatment: Have you sought treatment for a mental health condition?</li>
<li>Work Interfere: If you have a mental health condition, do you feel that it interferes with your work?</li>
<li>Remote Work: Do you work remotely (outside of an office) at least 50% of the time?</li>
<li>Tech Company: Is your employer primarily a tech company/organization?</li>
<li>Benefits: Does your employer provide mental health benefits?</li>
<li>Leave: How easy is it for you to take medical leave for a mental health condition?</li>
<li>Mental Health Consequence: Do you think that discussing a mental health issue with your employer would have negative consequences?</li>
</ul>
<section id="cleaning-the-header-row" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-the-header-row">Cleaning the header row</h3>
<p>A good practice, both in terms of ensuring a consistent convention for column names and for the ability to write more efficient code, is to ensure that all column header names do not have spaces in them and are all in lower case. To do this with our current dataset, we use the <code>str.replace()</code> function on all the header row, identified in pandas via .columns:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>m_health.columns <span class="op">=</span> m_health.columns.<span class="bu">str</span>.replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>m_health.columns <span class="op">=</span> m_health.columns.<span class="bu">str</span>.lower()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>m_health.head(<span class="dv">10</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>m_health.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 24 entries, 0 to 23
Data columns (total 13 columns):
 #   Column                     Non-Null Count  Dtype 
---  ------                     --------------  ----- 
 0   timestamp                  24 non-null     object
 1   age                        24 non-null     int64 
 2   gender                     24 non-null     object
 3   country                    24 non-null     object
 4   self_employed              24 non-null     object
 5   family_history             24 non-null     object
 6   treatment                  24 non-null     object
 7   work_interfere             24 non-null     object
 8   remote_work                24 non-null     object
 9   tech_company               24 non-null     object
 10  benefits                   24 non-null     object
 11  leave                      24 non-null     object
 12  mental_health_consequence  24 non-null     object
dtypes: int64(1), object(12)
memory usage: 2.6+ KB</code></pre>
</div>
</div>
<p>The other thing to notice that there are no missing values! So we can just concentrate on other cleaning tasks.</p>
</section>
<section id="ensuring-the-right-datatypes" class="level3">
<h3 class="anchored" data-anchor-id="ensuring-the-right-datatypes">Ensuring the right datatypes</h3>
<p>A good practice is to notice whether there are series in the dataframe that are improperly datatyped (that is, where the “Dtype” indicated does not correspond to the datatype that it should be).</p>
<p>Taking a look at the data, we notice that “Timestamp” is datatyped as an “object”, which in this context means a “string”. However, that is sub-optimal because the content is time-oriented, and by coding it as an object/string, we limit a lot of its value. If we identify datatype as a time oriented one, that can give us advantages downstream in being able to work with the data more elegantly.</p>
<p>Pandas has functions specifically designed to cast datatypes from one to another, as was covered in the previous section with the <code>astype()</code> function.</p>
<p>To cast a variable as a datetime datatype, we can use the pandas <code>to_datetime()</code> function and pass in the pandas series you want to modify:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'timestamp'</span>] <span class="op">=</span> pd.to_datetime(m_health[<span class="st">'timestamp'</span>])</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>m_health.head()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>m_health.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 24 entries, 0 to 23
Data columns (total 13 columns):
 #   Column                     Non-Null Count  Dtype         
---  ------                     --------------  -----         
 0   timestamp                  24 non-null     datetime64[ns]
 1   age                        24 non-null     int64         
 2   gender                     24 non-null     object        
 3   country                    24 non-null     object        
 4   self_employed              24 non-null     object        
 5   family_history             24 non-null     object        
 6   treatment                  24 non-null     object        
 7   work_interfere             24 non-null     object        
 8   remote_work                24 non-null     object        
 9   tech_company               24 non-null     object        
 10  benefits                   24 non-null     object        
 11  leave                      24 non-null     object        
 12  mental_health_consequence  24 non-null     object        
dtypes: datetime64[ns](1), int64(1), object(11)
memory usage: 2.6+ KB</code></pre>
</div>
</div>
<p>Et voila - timestamp is now of the datatime64 datatype! Were we wanting to leverage timestamp’s date time qualities, we could now do so more easily. It should be added, that this example works well because the existing data is nicely formatted to be understood as data/time datatype data. In the real world, if the timestamp column has different date types, or isn’t actually a date column at all, the method raises exceptions that you will have to work through. For example, look at what happens if we try to force a different variable into a data/time data type:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'tech_company'</span>] <span class="op">=</span> pd.to_datetime(m_health[<span class="st">'tech_company'</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>m_health.head()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>m_health.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ParserError: Unknown string format: Yes</code></pre>
</div>
</div>
<p>The error let’s us know that this data typing conversion will not work as coded.</p>
</section>
<section id="recoding-values" class="level3">
<h3 class="anchored" data-anchor-id="recoding-values">Recoding values</h3>
<p>Value recoding is a data cleaning task to put the column values into more manageable categories. This is a common data recoding task that most data analyst type folks will be familiar with. Pandas alone has many functions that solve recoding issues in different ways. We will just highlight a few in this tutorial.</p>
<p>With this dataset we’ve called there are a few columns that we would like to make changes to so that it will be easier to analyze the data in the way we want. The <code>value_counts()</code> method shows the range of responses and their frequency in the dataframe.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'gender'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>Male        12
male         6
M            2
Female       1
m            1
F            1
Cis Male     1
Name: gender, dtype: int64</code></pre>
</div>
</div>
<p>With that knowledge, we can utilize the <code>replace()</code> function and pass in custom lists with all of the responses that should be replaced by a single specfied value.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'gender'</span>].replace([<span class="st">'Male '</span>, <span class="st">'male'</span>, <span class="st">'M'</span>, <span class="st">'m'</span>, <span class="st">'Male'</span>, <span class="st">'Cis Male'</span>],</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Male'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'gender'</span>].replace([<span class="st">'Female '</span>, <span class="st">'female'</span>, <span class="st">'F'</span>],</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Female'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'gender'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>Male      22
Female     2
Name: gender, dtype: int64</code></pre>
</div>
</div>
<p>Another task is to put categorical objects into a form that is more amenable to computational tasks. Let’s take a look at a categorial variable that consists of responses of “Yes” and “No”.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'self_employed'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>No     23
Yes     1
Name: self_employed, dtype: int64</code></pre>
</div>
</div>
<p>If we want to leverage this data purely as a segment to split other metrics with, we would probably leave as is. But perhaps we would like to treat it as a dummy variable so we can do more sophisticated math with it.</p>
<p>For our self-employed variable, we begin by implementing <code>replace()</code> to transform the existing content to numbers as shown below:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'self_employed'</span>].replace([<span class="st">'Yes'</span>], <span class="st">'1'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'self_employed'</span>].replace([<span class="st">'No'</span>], <span class="st">'0'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'self_employed'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>0    23
1     1
Name: self_employed, dtype: int64</code></pre>
</div>
</div>
<p>The pandas <code>astype()</code> function is able to interpret the 1s and 0s as integers and so we can transform the series into an <code>int</code> datatype.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'self_employed'</span>] <span class="op">=</span> m_health[<span class="st">'self_employed'</span>] <span class="op">\</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>        .astype(dtype<span class="op">=</span><span class="st">'int'</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>m_health.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>timestamp</th>
      <th>age</th>
      <th>gender</th>
      <th>country</th>
      <th>self_employed</th>
      <th>family_history</th>
      <th>treatment</th>
      <th>work_interfere</th>
      <th>remote_work</th>
      <th>tech_company</th>
      <th>benefits</th>
      <th>leave</th>
      <th>mental_health_consequence</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-08-27 11:35:00</td>
      <td>46</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Often</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-08-27 11:36:00</td>
      <td>41</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Never</td>
      <td>No</td>
      <td>No</td>
      <td>Don't know</td>
      <td>Don't know</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014-08-27 11:36:00</td>
      <td>33</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Rarely</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2014-08-27 11:37:00</td>
      <td>35</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Sometimes</td>
      <td>No</td>
      <td>No</td>
      <td>Yes</td>
      <td>Very easy</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2014-08-27 11:42:00</td>
      <td>35</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Rarely</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Very easy</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now we see that variable as a series of int-typed 0s and 1s. <br></p>
<div class="callout-warning callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Challenge 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>You would like to clean up the scale used in the question about whether one’s mental illness affects one’s work.</p>
<ol type="1">
<li><p>Find the column (pandas series) that needs to be transformed and transform its values using <code>replace()</code> with numerical values that make sense.</p></li>
<li><p>Display the modified dataframe showing the replaced values.</p></li>
</ol>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution to Challenge 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>First, find the distribution of cases per value label:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>Sometimes    12
Never         5
Rarely        4
Often         3
Name: work_interfere, dtype: int64</code></pre>
</div>
</div>
<p>Then show how to use replace to transform the scale into a numeric one:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].replace([<span class="st">'Never'</span>], <span class="st">'0'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].replace([<span class="st">'Rarely'</span>], <span class="st">'1'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].replace([<span class="st">'Sometimes'</span>], <span class="st">'2'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].replace([<span class="st">'Often'</span>], <span class="st">'3'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>2    12
0     5
1     4
3     3
Name: work_interfere, dtype: int64</code></pre>
</div>
</div>
<p>Distribution of values looks good. Let’s take a look at the datatypes for the dataframe object.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>m_health.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 24 entries, 0 to 23
Data columns (total 13 columns):
 #   Column                     Non-Null Count  Dtype         
---  ------                     --------------  -----         
 0   timestamp                  24 non-null     datetime64[ns]
 1   age                        24 non-null     int64         
 2   gender                     24 non-null     object        
 3   country                    24 non-null     object        
 4   self_employed              24 non-null     int64         
 5   family_history             24 non-null     object        
 6   treatment                  24 non-null     object        
 7   work_interfere             24 non-null     object        
 8   remote_work                24 non-null     object        
 9   tech_company               24 non-null     object        
 10  benefits                   24 non-null     object        
 11  leave                      24 non-null     object        
 12  mental_health_consequence  24 non-null     object        
dtypes: datetime64[ns](1), int64(2), object(10)
memory usage: 2.6+ KB</code></pre>
</div>
</div>
<p>But it is still typed as an object. So change datatype to int.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>] <span class="op">=</span> m_health[<span class="st">'work_interfere'</span>] <span class="op">\</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>        .astype(dtype<span class="op">=</span><span class="st">'int'</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>m_health.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 24 entries, 0 to 23
Data columns (total 13 columns):
 #   Column                     Non-Null Count  Dtype         
---  ------                     --------------  -----         
 0   timestamp                  24 non-null     datetime64[ns]
 1   age                        24 non-null     int64         
 2   gender                     24 non-null     object        
 3   country                    24 non-null     object        
 4   self_employed              24 non-null     int64         
 5   family_history             24 non-null     object        
 6   treatment                  24 non-null     object        
 7   work_interfere             24 non-null     int64         
 8   remote_work                24 non-null     object        
 9   tech_company               24 non-null     object        
 10  benefits                   24 non-null     object        
 11  leave                      24 non-null     object        
 12  mental_health_consequence  24 non-null     object        
dtypes: datetime64[ns](1), int64(3), object(9)
memory usage: 2.6+ KB</code></pre>
</div>
</div>
<p>Finally, show the dataframe itself.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>m_health</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>timestamp</th>
      <th>age</th>
      <th>gender</th>
      <th>country</th>
      <th>self_employed</th>
      <th>family_history</th>
      <th>treatment</th>
      <th>work_interfere</th>
      <th>remote_work</th>
      <th>tech_company</th>
      <th>benefits</th>
      <th>leave</th>
      <th>mental_health_consequence</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-08-27 11:35:00</td>
      <td>46</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>3</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-08-27 11:36:00</td>
      <td>41</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>Don't know</td>
      <td>Don't know</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014-08-27 11:36:00</td>
      <td>33</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>1</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2014-08-27 11:37:00</td>
      <td>35</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>2</td>
      <td>No</td>
      <td>No</td>
      <td>Yes</td>
      <td>Very easy</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2014-08-27 11:42:00</td>
      <td>35</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>1</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Very easy</td>
      <td>No</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2014-08-27 11:42:00</td>
      <td>24</td>
      <td>Male</td>
      <td>United Kingdom</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>2</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>Don't know</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2014-08-27 11:42:00</td>
      <td>35</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Somewhat difficult</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2014-08-27 11:43:00</td>
      <td>27</td>
      <td>Male</td>
      <td>Canada</td>
      <td>0</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>2</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>Very difficult</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2014-08-27 11:43:00</td>
      <td>18</td>
      <td>Male</td>
      <td>Netherlands</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>3</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>Somewhat difficult</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2014-08-27 11:43:00</td>
      <td>30</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>2</td>
      <td>No</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Don't know</td>
      <td>No</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2014-08-27 11:43:00</td>
      <td>38</td>
      <td>Female</td>
      <td>United States</td>
      <td>0</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>2</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Somewhat easy</td>
      <td>No</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2014-08-27 11:43:00</td>
      <td>28</td>
      <td>Male</td>
      <td>United Kingdom</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>No</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Don't know</td>
      <td>No</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2014-08-27 11:43:00</td>
      <td>34</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>Don't know</td>
      <td>No</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2014-08-27 11:43:00</td>
      <td>26</td>
      <td>Male</td>
      <td>Canada</td>
      <td>1</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>Don't know</td>
      <td>No</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2014-08-27 11:44:00</td>
      <td>30</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>1</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2014-08-27 12:12:00</td>
      <td>31</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Somewhat easy</td>
      <td>No</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2014-08-27 12:13:00</td>
      <td>40</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>Very difficult</td>
      <td>No</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2014-08-27 12:14:00</td>
      <td>34</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Somewhat easy</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2014-08-27 12:15:00</td>
      <td>25</td>
      <td>Female</td>
      <td>Canada</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>2</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2014-08-27 12:15:00</td>
      <td>29</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Don't know</td>
      <td>No</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2014-08-27 12:16:00</td>
      <td>24</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>Yes</td>
      <td>No</td>
      <td>1</td>
      <td>No</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Somewhat easy</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2014-08-27 12:17:00</td>
      <td>31</td>
      <td>Male</td>
      <td>Mexico</td>
      <td>0</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>2</td>
      <td>No</td>
      <td>Yes</td>
      <td>Don't know</td>
      <td>Don't know</td>
      <td>No</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2014-08-27 12:18:00</td>
      <td>33</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>2</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>Somewhat easy</td>
      <td>Maybe</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2014-08-27 12:18:00</td>
      <td>30</td>
      <td>Male</td>
      <td>United States</td>
      <td>0</td>
      <td>No</td>
      <td>Yes</td>
      <td>3</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>Somewhat easy</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./11_getting_data_with_pandas.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Getting Data With Pandas</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./21_exploring_data_structures.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Exploring Data Structures</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Introduction to Data Science using Python was written by <br> Lindsay Forestell and Stuart Hemerling</div>   
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="./license.qmd">License</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://bcgov.github.io/ds-intro-to-python/index.html">Python for Data Science Course</a>
  </li>  
</ul>
      </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>