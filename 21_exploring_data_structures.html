<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stuart Hemerling">

<title>Introduction to Data Science using Python - 6&nbsp; Exploring Data Structures</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./22_graphical_depictions_of_data.html" rel="next">
<link href="./12_cleaning_it_up.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./BCID_H_rgb_rev.png" alt="" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-introduction-to-python" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Introduction to Python</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-introduction-to-python">    
        <li>
    <a class="dropdown-item" href="./00_introduction_to_python.html">
 <span class="dropdown-text">Getting Up and Running</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01_working_with_code.html">
 <span class="dropdown-text">Working with Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_core_data_structure_concepts.html">
 <span class="dropdown-text">Core Concepts</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-get-and-clean-data" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Get and Clean Data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-get-and-clean-data">    
        <li>
    <a class="dropdown-item" href="./11_getting_data_with_pandas.html">
 <span class="dropdown-text">Getting Data with Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./12_cleaning_it_up.html">
 <span class="dropdown-text">Cleaning Data with Pandas</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-understand-and-analyze-data" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Understand and Analyze Data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-understand-and-analyze-data">    
        <li>
    <a class="dropdown-item" href="./21_exploring_data_structures.html">
 <span class="dropdown-text">Exploring Data Structures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./22_graphical_depictions_of_data.html">
 <span class="dropdown-text">Graphical Depictions of Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-advanced-topics" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Advanced Topics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-advanced-topics">    
        <li>
    <a class="dropdown-item" href="./31_bcdata.html">
 <span class="dropdown-text">bcdata package</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./32_advanced_pandas.html">
 <span class="dropdown-text">Advanced Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./33_create_reports.html">
 <span class="dropdown-text">Creating Reports</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./34_machine_learning.html">
 <span class="dropdown-text">Machine Learning</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./references.html">
 <span class="menu-text">References</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bcgov/ds-intro-to-python"><i class="bi bi-github" role="img" aria-label="Source Code">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown  compact">
    <a class="nav-link dropdown-toggle" href="#" id="" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-share" role="img" aria-label="Share">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="">    
        <li>
    <a class="dropdown-item" href="https://twitter.com/intent/tweet?url=|url|"><i class="bi bi-twitter" role="img">
</i> 
 <span class="dropdown-text">Twitter</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|"><i class="bi bi-facebook" role="img">
</i> 
 <span class="dropdown-text">Facebook</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Exploring Data Structures</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./cover.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_introduction_to_python.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Up and Running</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_working_with_code.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Working with Code</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_core_data_structure_concepts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Core Concepts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_getting_data_with_pandas.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Getting Data With Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_cleaning_it_up.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Cleaning Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_exploring_data_structures.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Exploring Data Structures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_graphical_depictions_of_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Graphical Depictions of Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31_bcdata.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to bcdata</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32_advanced_pandas.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Advanced Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33_create_reports.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Creating Reports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34_machine_learning.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Machine Learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#exploring-and-understanding-data" id="toc-exploring-and-understanding-data" class="nav-link active" data-scroll-target="#exploring-and-understanding-data"><span class="toc-section-number">6.1</span>  Exploring and Understanding Data</a></li>
  <li><a href="#selecting-columns-variables" id="toc-selecting-columns-variables" class="nav-link" data-scroll-target="#selecting-columns-variables"><span class="toc-section-number">6.2</span>  Selecting columns (variables)</a></li>
  <li><a href="#selecting-rows" id="toc-selecting-rows" class="nav-link" data-scroll-target="#selecting-rows"><span class="toc-section-number">6.3</span>  Selecting rows</a></li>
  <li><a href="#sorting-rows" id="toc-sorting-rows" class="nav-link" data-scroll-target="#sorting-rows"><span class="toc-section-number">6.4</span>  Sorting rows</a></li>
  <li><a href="#putting-multiple-methods-together" id="toc-putting-multiple-methods-together" class="nav-link" data-scroll-target="#putting-multiple-methods-together"><span class="toc-section-number">6.5</span>  Putting multiple methods together</a></li>
  <li><a href="#creating-new-columns-of-data" id="toc-creating-new-columns-of-data" class="nav-link" data-scroll-target="#creating-new-columns-of-data"><span class="toc-section-number">6.6</span>  Creating new columns of data</a></li>
  <li><a href="#joining-datasets-together" id="toc-joining-datasets-together" class="nav-link" data-scroll-target="#joining-datasets-together"><span class="toc-section-number">6.7</span>  Joining datasets together</a></li>
  <li><a href="#grouping-and-summarizing" id="toc-grouping-and-summarizing" class="nav-link" data-scroll-target="#grouping-and-summarizing"><span class="toc-section-number">6.8</span>  Grouping and summarizing</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/bcgov/ds-intro-to-python/blob/main/21_exploring_data_structures.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/bcgov/ds-intro-to-python/edit/main/21_exploring_data_structures.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/bcgov/ds-intro-to-python/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Exploring Data Structures</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Stuart Hemerling </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="exploring-and-understanding-data" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="exploring-and-understanding-data"><span class="header-section-number">6.1</span> Exploring and Understanding Data</h2>
<p>Getting a high level summary of the data is important but data is particularly valuable when refined. Your analysis will start to come alive when we start to do some slicing and dicing and grouping of data or even creating additional variables. In an Excel world, this is like when you use filter options for columns, or create pivot tables, or when you create a formula in a new column to create a new variable. In data science parlance, this is the kind of thing that is referred to as <code>data wrangling</code> - getting the data you want in the form you want it in.</p>
<p>In the world of python, this usually means working with a library or package you have already been introduced to called pandas. It lets you do so much!</p>
<p>The first dataset we’ll look at is one that looks at data for countries around the world and shows population counts, life expectancy and GDP per capita over a number of years. Let’s import the pandas library and then use the <code>.read_csv()</code> function to get some population by country data. We will read the data into an object that will call <code>country_metrics</code>, so that it is easier for us to remember what it consists of.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span>\</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ds-intro-to-python/main/data/gapfinder.csv"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>country_metrics <span class="op">=</span> pd.read_csv(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s usually a good idea right away to take a quick look at the data to make sure what we have read in makes sense. The <code>.info()</code> method prints the number of columns, column labels, column data types, memory usage, range index, and the number of cells in each column (non-null values).</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Reminder: Naming variables!
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you create a variable or object, you can name it pretty much whatever you want. You will see widespread use of the name “df” on the internet, which stands for “dataframe”. However, as it is good practice to name your data something that relates to the contents. Naming it something intuitive will help reduce chance for confusion as you develop code. Objects you create should be some noun that is at the same time intuitive but not overly verbose. Also remember the form is important too. Remember not to not leave spaces in your names, and to always be consistent in the naming conventions you use (e.g.&nbsp;camelCase, underscore_case, etc.).</p>
</div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>country_metrics.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1704 entries, 0 to 1703
Data columns (total 6 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   country    1704 non-null   object 
 1   year       1704 non-null   int64  
 2   pop        1704 non-null   float64
 3   continent  1704 non-null   object 
 4   lifeExp    1704 non-null   float64
 5   gdpPercap  1704 non-null   float64
dtypes: float64(3), int64(1), object(2)
memory usage: 80.0+ KB</code></pre>
</div>
</div>
<p>So this data is looking good so far. We can see that we have created a pandas dataframe within our python environment. There are 1204 rows of data and six columns or variables. You can see there are only non-null values… so happily there is no missing data to worry about.</p>
<p>The <code>.head()</code> pandas method lets us look at actual data in a somewhat similar way to how one does in an Excel spreadsheet.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>country_metrics.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>8425333.0</td>
      <td>Asia</td>
      <td>28.801</td>
      <td>779.445314</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>9240934.0</td>
      <td>Asia</td>
      <td>30.332</td>
      <td>820.853030</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>While we don’t learn too too much from this look, but we do see some sample data to see and start getting familiar with visually.<br>
<br></p>
</section>
<section id="selecting-columns-variables" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="selecting-columns-variables"><span class="header-section-number">6.2</span> Selecting columns (variables)</h2>
<p>In the “real world” of data it is not uncommon to see hundreds or even thousands of columns in a single dataframe, so knowing how to pare down our dataset so it is not overly bloated is important.</p>
<center>
<img src="images/exploring-data-structures/select_columns.png" width="60%" style="margin:auto">
<p style="text-align: center">
Selecting Columns
</p>
<br>
</center>
<p>First things first. If we want to look the contents of a single column, we could do it like this, specifying the column name after the <code>.</code> without parentheses:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>country_metrics.country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0       Afghanistan
1       Afghanistan
2       Afghanistan
3       Afghanistan
4       Afghanistan
           ...     
1699       Zimbabwe
1700       Zimbabwe
1701       Zimbabwe
1702       Zimbabwe
1703       Zimbabwe
Name: country, Length: 1704, dtype: object</code></pre>
</div>
</div>
<p>When we want to select more than one column to include in our dataframe, we use the convention <code>df[['col1', 'col2']]</code> to select the columns we want.</p>
<p>In our example below, we will create a new dataframe called <code>narrow_country_metrics</code>. We are primarily interested in getting the population metric from the original dataset, and since we want to be able to analyze it by year, country, and continent, we will add those into our new dataframe also. So the dataset will be more narrow than the one it was created from.</p>
<p>There are two ways to approach this. The first way to approach is to identify all the columns you want to keep.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>narrow_country_metrics <span class="op">=</span> country_metrics[</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'country'</span>, <span class="st">'year'</span>, <span class="st">'pop'</span>, <span class="st">'continent'</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>narrow_country_metrics.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>8425333.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>9240934.0</td>
      <td>Asia</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The second way is use the pandas <code>.drop()</code> method to eliminate the columns from the original object that you do not want to keep. Thus in the end we can achieve the same result as the example above by simply dropping two variables instead of naming four. With this method, we also need to add the specification <code>axis = 1</code>, which indicates that it is columns (and not rows) being referenced for being dropped.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>narrow_country_metrics <span class="op">=</span> country_metrics.drop(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'lifeExp'</span>, <span class="st">'gdpPercap'</span>], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>narrow_country_metrics.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>8425333.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>9240934.0</td>
      <td>Asia</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Either way we have a more manageable dataset to work with called <code>narrow_country_metrics</code>. The original dataframe <code>country_metrics</code> is still there, and it still the same shape as before, we have not changed it.</p>
<p>However, it is important to realize that in python it is very common to change an object <em>by referring to that object on both sides of the assignment operator</em>. In the code below, we narrow the <code>narrow_country_metrics</code> dataset down even further by removing the column <code>pop</code> as well.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>narrow_country_metrics <span class="op">=</span> narrow_country_metrics.drop([<span class="st">'pop'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>narrow_country_metrics.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>Asia</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>If we want to have the <code>pop</code> variable back in the narrow_country_metrics object, we will need to recreate it from the source it came from, where <code>pop</code> was still intact.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Reminder on Assignment!
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you create a variable or dataframe object in python, to the left of the <code>=</code> sign you always put the name of the object you want to make or modify. To the right, that’s where you put the content that shows how the existing object is to be modified. It may feel counterintuitive but don’t be concerned, it is the standard way that the code is structured to be understood.</p>
</div>
</div>
<div class="callout-warning callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Challenge 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let’s say you want to narrow down the dataset to include only the country and the year. How would you do it? Don’t forget to run your code so it also shows a view of the result so you can confirm the code worked as you wanted it to.</p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution to Challenge 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>First you would like to create a new object to hold this narrowed down version of the dataset, then use the <code>.head()</code> to see some of the resulting data.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>challenge1_df <span class="op">=</span> country_metrics[[<span class="st">'country'</span>, <span class="st">'year'</span>]]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>challenge1_df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="selecting-rows" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="selecting-rows"><span class="header-section-number">6.3</span> Selecting rows</h2>
<p>Of course, in data analysis we are usually interested in looking at just some rows of data, not <em>all</em> rows <em>all</em> the time.</p>
<center>
<img src="images/exploring-data-structures/select_rows.png" width="60%" style="margin:auto">
<p style="text-align: center">
Selecting Rows
</p>
<br>
</center>
<p><em>Relational operators</em></p>
<p>When we want to look at just selected rows (i.e.&nbsp;select rows that have certain values within a given column) we can supply a condition that must be met for a given row in that column. To do this, we must use one of the following <em>comparison operators</em>, which are also called <em>relational operators</em>:</p>
<ul>
<li>equal to <code>==</code></li>
<li>not equal to <code>!=</code></li>
<li>less than <code>&lt;</code></li>
<li>greater than <code>&gt;</code></li>
<li>less than or equal to <code>&lt;=</code></li>
<li>greater than or equal to <code>&gt;=</code></li>
</ul>
<p>Let’s try an example. The most commonly used relational operator is likely equal to (<code>==</code>). In the example below we have a statement that pandas evaluates line by line in the dataframe as to whether it corresponds to a boolean value of <code>True</code> or <code>False</code>.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>country_metrics[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">1972</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>0       False
1       False
2       False
3       False
4        True
        ...  
1699    False
1700    False
1701    False
1702    False
1703    False
Name: year, Length: 1704, dtype: bool</code></pre>
</div>
</div>
<p>When we create an object from this evaluation in pandas, it returns to that object only the rows that evaluate as <code>True</code>:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>filtered_country_metrics <span class="op">=</span> country_metrics[country_metrics[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">1972</span>]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>filtered_country_metrics.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>1972</td>
      <td>13079460.0</td>
      <td>Asia</td>
      <td>36.088</td>
      <td>739.981106</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Albania</td>
      <td>1972</td>
      <td>2263554.0</td>
      <td>Europe</td>
      <td>67.690</td>
      <td>3313.422188</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><br> <em>Logical operators</em></p>
<p>In python, it is common to use the logical operators <code>and</code>, <code>or</code>, and <code>not</code> to evaluate expressions. For example, as in the code below, python evaluates the <code>and</code> to see whether BOTH operands are true:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x <span class="op">&gt;</span> <span class="dv">3</span> <span class="kw">and</span> x <span class="op">&lt;</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True</code></pre>
</div>
</div>
<p>However, when we ask pandas to evaluate whether a set of logical relations exist within a pandas series object, we must use pandas <em>bitwise</em> logical operators, whose syntax is different:</p>
<ul>
<li>and <code>&amp;</code></li>
<li>or <code>|</code></li>
<li>not <code>~</code></li>
</ul>
<p>When combining multiple conditional statements in a pandas series object, each condition must be surrounded by parentheses <code>()</code> within the square brackets <code>[]</code>. In the example below, we use an <code>&amp;</code> to indicate that both conditions must be true for a row to be returned:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>filtered_country_metrics <span class="op">=</span> country_metrics[</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">1972</span>) <span class="op">&amp;</span>   </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'country'</span>] <span class="op">==</span> <span class="st">'Albania'</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>filtered_country_metrics.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Albania</td>
      <td>1972</td>
      <td>2263554.0</td>
      <td>Europe</td>
      <td>67.69</td>
      <td>3313.422188</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>In the example above, there is only one row of data that matches the condition.</p>
<p>We can use the <code>|</code> which indicates that if <em>either or both</em> of the conditions are true for a given row, that row is returned into the object:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>filtered_country_metrics <span class="op">=</span> country_metrics[</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">1972</span>) <span class="op">|</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'country'</span>] <span class="op">==</span> <span class="st">'Albania'</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>filtered_country_metrics.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>1972</td>
      <td>13079460.0</td>
      <td>Asia</td>
      <td>36.088</td>
      <td>739.981106</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Albania</td>
      <td>1952</td>
      <td>1282697.0</td>
      <td>Europe</td>
      <td>55.230</td>
      <td>1601.056136</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Albania</td>
      <td>1957</td>
      <td>1476505.0</td>
      <td>Europe</td>
      <td>59.280</td>
      <td>1942.284244</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Albania</td>
      <td>1962</td>
      <td>1728137.0</td>
      <td>Europe</td>
      <td>64.820</td>
      <td>2312.888958</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Albania</td>
      <td>1967</td>
      <td>1984060.0</td>
      <td>Europe</td>
      <td>66.220</td>
      <td>2760.196931</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>In the example above, there are many rows that satisfy one or the other condition. As an aside, were we to want to know <em>how many rows</em> fulfill this | situation, we could have called the .info() method instead of .head().</p>
<div class="callout-warning callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Challenge 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Your director has come to you and asked if you know what the life expectancy has been in Canada since 1992. How would you use pandas code to get the data you need? And after having run the code, what’s the answer?</p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution to Challenge 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>First you would like to create a new object to hold this narrowed down version of the dataset, then use some method like <code>.print()</code> or <code>.head()</code> to see some of the resulting data.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>challenge2_df <span class="op">=</span> country_metrics[</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">1992</span>) <span class="op">&amp;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'country'</span>] <span class="op">==</span> <span class="st">'Canada'</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    ]    </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>challenge2_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>248</th>
      <td>Canada</td>
      <td>1992</td>
      <td>28523502.0</td>
      <td>Americas</td>
      <td>77.950</td>
      <td>26342.88426</td>
    </tr>
    <tr>
      <th>249</th>
      <td>Canada</td>
      <td>1997</td>
      <td>30305843.0</td>
      <td>Americas</td>
      <td>78.610</td>
      <td>28954.92589</td>
    </tr>
    <tr>
      <th>250</th>
      <td>Canada</td>
      <td>2002</td>
      <td>31902268.0</td>
      <td>Americas</td>
      <td>79.770</td>
      <td>33328.96507</td>
    </tr>
    <tr>
      <th>251</th>
      <td>Canada</td>
      <td>2007</td>
      <td>33390141.0</td>
      <td>Americas</td>
      <td>80.653</td>
      <td>36319.23501</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p>You will find that it is very common within python/pandas to see the <code>.iloc()</code> function used, so it is worthwhile to give that a brief introduction also.</p>
<p>This function enables the selection of data from a particular row or column, according to the integer based position index as shown in the image below:</p>
<center>
<img src="images/exploring-data-structures/pandasdf.png" style="margin:auto">
<p style="text-align: center">
Row and column values iloc() refers to
</p>
<br>
</center>
<p>By referring to these locations, we can use <code>iloc()</code> to retrieve the exact cells we want to see. For example, if we just want the row of data corresponding to the index integer value 5, we would run the following code:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>country_metrics.iloc[<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>country      Afghanistan
year                1977
pop           14880372.0
continent           Asia
lifeExp           38.438
gdpPercap      786.11336
Name: 5, dtype: object</code></pre>
</div>
</div>
<p>We can also modify the above call to look at column(s)! For example, we specify the row(s) of interest to the left of a <code>comma</code> in the square brackets, and the column(s) of interest to the right of it. In the example below, the code will retrieve just the content found at the intersection of row 5 and column 3:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>country_metrics.iloc[<span class="dv">5</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>'Asia'</code></pre>
</div>
</div>
<p>We can also retrieve <em>ranges</em> of rows and columns respectively by employing a <code>colon</code> along with the starting and ending rows or columns we want. In the example below, we want to get rows “0” through “2” and the columns “0” through “3”:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>country_metrics.iloc[<span class="dv">0</span>:<span class="dv">2</span>,<span class="dv">0</span>:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>8425333.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>9240934.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>It is a flexible tool that can be very helpful as you build and review your code. <br></p>
</section>
<section id="sorting-rows" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="sorting-rows"><span class="header-section-number">6.4</span> Sorting rows</h2>
<p>So now you’ve mastered how to select rows and columns you want, congratulations! Instead of hunting and pecking for insights, one way to quickly make some sense of the data is to sort it - something you probably do in Excel all the time.</p>
<p>Let’s say we wanted to know more about Asian countries since 2002. First we should go ahead and create a dataframe that consists of just the data we are wanting to look at.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>countries_2000s <span class="op">=</span> country_metrics[</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">2002</span>) <span class="op">&amp;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">'Asia'</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    ]    </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>countries_2000s.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>Afghanistan</td>
      <td>2002</td>
      <td>25268405.0</td>
      <td>Asia</td>
      <td>42.129</td>
      <td>726.734055</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Afghanistan</td>
      <td>2007</td>
      <td>31889923.0</td>
      <td>Asia</td>
      <td>43.828</td>
      <td>974.580338</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Bahrain</td>
      <td>2002</td>
      <td>656397.0</td>
      <td>Asia</td>
      <td>74.795</td>
      <td>23403.559270</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Bahrain</td>
      <td>2007</td>
      <td>708573.0</td>
      <td>Asia</td>
      <td>75.635</td>
      <td>29796.048340</td>
    </tr>
    <tr>
      <th>106</th>
      <td>Bangladesh</td>
      <td>2002</td>
      <td>135656790.0</td>
      <td>Asia</td>
      <td>62.013</td>
      <td>1136.390430</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>This is a nice start. But to see some meaningful insights it is helpful to sort the metric we are interested in something other than the default way the data appear positioned in the dataframe.</p>
<p>The <code>.sort_values()</code> method let’s us specify a column (or multiple columns) we want to sort and enter an argument that indicates in which direction we would like it to be sorted, from low to high or vice-versa. We want life expectancy from high to low, so the ascending parameter should be set to <code>False</code>.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>countries_2000s <span class="op">=</span> countries_2000s.sort_values(<span class="st">'lifeExp'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>countries_2000s.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>803</th>
      <td>Japan</td>
      <td>2007</td>
      <td>127467972.0</td>
      <td>Asia</td>
      <td>82.603</td>
      <td>31656.06806</td>
    </tr>
    <tr>
      <th>671</th>
      <td>Hong Kong China</td>
      <td>2007</td>
      <td>6980412.0</td>
      <td>Asia</td>
      <td>82.208</td>
      <td>39724.97867</td>
    </tr>
    <tr>
      <th>802</th>
      <td>Japan</td>
      <td>2002</td>
      <td>127065841.0</td>
      <td>Asia</td>
      <td>82.000</td>
      <td>28604.59190</td>
    </tr>
    <tr>
      <th>670</th>
      <td>Hong Kong China</td>
      <td>2002</td>
      <td>6762476.0</td>
      <td>Asia</td>
      <td>81.495</td>
      <td>30209.01516</td>
    </tr>
    <tr>
      <th>767</th>
      <td>Israel</td>
      <td>2007</td>
      <td>6426679.0</td>
      <td>Asia</td>
      <td>80.745</td>
      <td>25523.27710</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>That was pretty straightforward and it helps us get more insights. Looks like Japan, in 2007, was the Asian country with the highest life expectancy.</p>
<p>Often one will want to sort by more than one column. To do that, instead of passing in a single column, we pass in a <em>list</em> of the columns we want to sort on. We can also control whether we would like each column to be sorted in ascending or descending order by passing in a respective list of boolean values in the <code>ascending=</code> parameter. In the example below, the code indicates that we want to sort first by ‘country’ in reverse alphabetical order, then by life expectancy from high to low.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>countries_2000s <span class="op">=</span> countries_2000s.sort_values(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'country'</span>, <span class="st">'lifeExp'</span>], ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">False</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>countries_2000s.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1679</th>
      <td>Yemen Rep.</td>
      <td>2007</td>
      <td>22211743.0</td>
      <td>Asia</td>
      <td>62.698</td>
      <td>2280.769906</td>
    </tr>
    <tr>
      <th>1678</th>
      <td>Yemen Rep.</td>
      <td>2002</td>
      <td>18701257.0</td>
      <td>Asia</td>
      <td>60.308</td>
      <td>2234.820827</td>
    </tr>
    <tr>
      <th>1667</th>
      <td>West Bank and Gaza</td>
      <td>2007</td>
      <td>4018332.0</td>
      <td>Asia</td>
      <td>73.422</td>
      <td>3025.349798</td>
    </tr>
    <tr>
      <th>1666</th>
      <td>West Bank and Gaza</td>
      <td>2002</td>
      <td>3389578.0</td>
      <td>Asia</td>
      <td>72.370</td>
      <td>4515.487575</td>
    </tr>
    <tr>
      <th>1655</th>
      <td>Vietnam</td>
      <td>2007</td>
      <td>85262356.0</td>
      <td>Asia</td>
      <td>74.249</td>
      <td>2441.576404</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We see that when we created and sorted this new object, the index values are those that were associated with the original <code>country_metrics</code> dataframe.</p>
<p>Depending on what we want to do with <code>countries_2000s</code> going forward, we might want to create a new “default” index for it instead of the existing one. That’s where the <code>.reset_index()</code> function comes into play.</p>
<p>In the code below, we reset the index.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>countries_2000s <span class="op">=</span> countries_2000s.reset_index(drop<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>countries_2000s.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>index</th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1679</td>
      <td>Yemen Rep.</td>
      <td>2007</td>
      <td>22211743.0</td>
      <td>Asia</td>
      <td>62.698</td>
      <td>2280.769906</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1678</td>
      <td>Yemen Rep.</td>
      <td>2002</td>
      <td>18701257.0</td>
      <td>Asia</td>
      <td>60.308</td>
      <td>2234.820827</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1667</td>
      <td>West Bank and Gaza</td>
      <td>2007</td>
      <td>4018332.0</td>
      <td>Asia</td>
      <td>73.422</td>
      <td>3025.349798</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1666</td>
      <td>West Bank and Gaza</td>
      <td>2002</td>
      <td>3389578.0</td>
      <td>Asia</td>
      <td>72.370</td>
      <td>4515.487575</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1655</td>
      <td>Vietnam</td>
      <td>2007</td>
      <td>85262356.0</td>
      <td>Asia</td>
      <td>74.249</td>
      <td>2441.576404</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Notice how the original index now is turned into a column itself called “index”. Depending on the use case, we might want to <em>keep</em> this column in the new dataframe. For example, if we ultimately wanted to join this dataframe back with the original it could act as a key. If we know, however, that it is of no value anymore to us, we can and probably should delete it. To do this, we would have set the <code>drop</code> parameter above to <code>True</code>.</p>
<p>Let’s use the iloc() method to look at the positional content of this <code>countries_2000s</code> object and confirm that Yeman shows up in row 0 as we expect.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>countries_2000s.iloc[<span class="dv">0</span>:<span class="dv">4</span>,<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>index</th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1679</td>
      <td>Yemen Rep.</td>
      <td>2007</td>
      <td>22211743.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1678</td>
      <td>Yemen Rep.</td>
      <td>2002</td>
      <td>18701257.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1667</td>
      <td>West Bank and Gaza</td>
      <td>2007</td>
      <td>4018332.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1666</td>
      <td>West Bank and Gaza</td>
      <td>2002</td>
      <td>3389578.0</td>
      <td>Asia</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="putting-multiple-methods-together" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="putting-multiple-methods-together"><span class="header-section-number">6.5</span> Putting multiple methods together</h2>
<p>The next step is usually to bring several of these commands together to get a nicely refined look at the data. Essentially you will need to invoke a number of calls sequentially to some object, with each one in turn performing some action on it.</p>
<p>A common approach is to put the object name on each sucessive line of code along with the <code>=</code> operator as well as the modifying code to the right. Imagine we were given the following task:</p>
<ol type="1">
<li>Select only the rows where the country is equal to Ireland AND where the year is 1992 or greater</li>
<li>Take these rows and sort them by year, going from high to low values, top to bottom</li>
</ol>
<p>The example below shows how we would employ the line-by-line approach:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>chained2_df <span class="op">=</span> country_metrics[(country_metrics[<span class="st">'country'</span>] <span class="op">==</span> <span class="st">'Ireland'</span>)]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>chained2_df <span class="op">=</span> chained2_df[(chained2_df[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">1992</span>)]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>chained2_df <span class="op">=</span> chained2_df.sort_values(<span class="st">'year'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>chained2_df.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>755</th>
      <td>Ireland</td>
      <td>2007</td>
      <td>4109086.0</td>
      <td>Europe</td>
      <td>78.885</td>
      <td>40675.99635</td>
    </tr>
    <tr>
      <th>754</th>
      <td>Ireland</td>
      <td>2002</td>
      <td>3879155.0</td>
      <td>Europe</td>
      <td>77.783</td>
      <td>34077.04939</td>
    </tr>
    <tr>
      <th>753</th>
      <td>Ireland</td>
      <td>1997</td>
      <td>3667233.0</td>
      <td>Europe</td>
      <td>76.122</td>
      <td>24521.94713</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>You can read fairly clearly what is happening in each line.</p>
<p>You can also put multiple methods in the same line of code, as long as you separate each of the elements. In pandas, this is sometimes referred to as joining or chaining, as you are essentially creating a joining/chaining actions together.</p>
<p>The code below accomplishes what the more verbose code above does but in a more efficient way:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>chained_df <span class="op">=</span> country_metrics[</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'country'</span>] <span class="op">==</span> <span class="st">'Ireland'</span>) <span class="op">&amp;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">1992</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    ].sort_values(<span class="st">'year'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>chained_df.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>755</th>
      <td>Ireland</td>
      <td>2007</td>
      <td>4109086.0</td>
      <td>Europe</td>
      <td>78.885</td>
      <td>40675.99635</td>
    </tr>
    <tr>
      <th>754</th>
      <td>Ireland</td>
      <td>2002</td>
      <td>3879155.0</td>
      <td>Europe</td>
      <td>77.783</td>
      <td>34077.04939</td>
    </tr>
    <tr>
      <th>753</th>
      <td>Ireland</td>
      <td>1997</td>
      <td>3667233.0</td>
      <td>Europe</td>
      <td>76.122</td>
      <td>24521.94713</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Each line is executed in sequence, so be careful when constructing code that the order in which you modify your dataframe is what you intend. Take the example below, in which we want to find European values for GDP per capita. In it, we first have a line of code that selects the rows that contain “Europe” in the first line, then looks at the column values for “year”, “country”, and “gdpPercap”.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>year_country_gdp <span class="op">=</span> country_metrics[</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">'Europe'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>year_country_gdp <span class="op">=</span> year_country_gdp[[<span class="st">'year'</span>, <span class="st">'country'</span>, <span class="st">'gdpPercap'</span>]]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>year_country_gdp.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>year</th>
      <th>country</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>1952</td>
      <td>Albania</td>
      <td>1601.056136</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1957</td>
      <td>Albania</td>
      <td>1942.284244</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1962</td>
      <td>Albania</td>
      <td>2312.888958</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Had we reversed the lines of code, and selected the “year”, “country”, and “gdpPercap” columns first to put into our new object, we would not have been able to sort for “Europe” in the “continent” column, as the “continent” would have been essentially removed from the dataframe in the step above. So an error would have been thrown.</p>
<div class="callout-warning callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Challenge 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Your director has come back to you and wondered about whether the life expectancy of people changed during the 1920s in Cambodia. Use what you know about selecting rows and sorting data to get the data you need to answer the question, sorted from most recent at the top.</p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution to Challenge 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Using code to select the country Cambodia, then call <code>sort_values()</code> method and chain them together and sorting by year in descending fashion. Looking at the data we see that in the 1920s there was a sharp decline in life expectancy in Cambodia. We also see, thankfully, that it has recovered strongly since then.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>challenge3_df <span class="op">=</span> country_metrics[</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    (country_metrics[<span class="st">'country'</span>] <span class="op">==</span> <span class="st">'Cambodia'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    ].sort_values(<span class="st">'year'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>challenge3_df.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>227</th>
      <td>Cambodia</td>
      <td>2007</td>
      <td>14131858.0</td>
      <td>Asia</td>
      <td>59.723</td>
      <td>1713.778686</td>
    </tr>
    <tr>
      <th>226</th>
      <td>Cambodia</td>
      <td>2002</td>
      <td>12926707.0</td>
      <td>Asia</td>
      <td>56.752</td>
      <td>896.226015</td>
    </tr>
    <tr>
      <th>225</th>
      <td>Cambodia</td>
      <td>1997</td>
      <td>11782962.0</td>
      <td>Asia</td>
      <td>56.534</td>
      <td>734.285170</td>
    </tr>
    <tr>
      <th>224</th>
      <td>Cambodia</td>
      <td>1992</td>
      <td>10150094.0</td>
      <td>Asia</td>
      <td>55.803</td>
      <td>682.303175</td>
    </tr>
    <tr>
      <th>223</th>
      <td>Cambodia</td>
      <td>1987</td>
      <td>8371791.0</td>
      <td>Asia</td>
      <td>53.914</td>
      <td>683.895573</td>
    </tr>
    <tr>
      <th>222</th>
      <td>Cambodia</td>
      <td>1982</td>
      <td>7272485.0</td>
      <td>Asia</td>
      <td>50.957</td>
      <td>624.475478</td>
    </tr>
    <tr>
      <th>221</th>
      <td>Cambodia</td>
      <td>1977</td>
      <td>6978607.0</td>
      <td>Asia</td>
      <td>31.220</td>
      <td>524.972183</td>
    </tr>
    <tr>
      <th>220</th>
      <td>Cambodia</td>
      <td>1972</td>
      <td>7450606.0</td>
      <td>Asia</td>
      <td>40.317</td>
      <td>421.624026</td>
    </tr>
    <tr>
      <th>219</th>
      <td>Cambodia</td>
      <td>1967</td>
      <td>6960067.0</td>
      <td>Asia</td>
      <td>45.415</td>
      <td>523.432314</td>
    </tr>
    <tr>
      <th>218</th>
      <td>Cambodia</td>
      <td>1962</td>
      <td>6083619.0</td>
      <td>Asia</td>
      <td>43.415</td>
      <td>496.913648</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="creating-new-columns-of-data" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="creating-new-columns-of-data"><span class="header-section-number">6.6</span> Creating new columns of data</h2>
<p>Very often we have some data in our dataset that we want to transform to give us additional information. In Excel this is something that is done all the time by creating a formula in a cell that refers to other columns and applies some sort of logic or mathematical expression to it.</p>
<p>There are different ways you can go about this in pandas. The most straightforward way is to define a new column on the left of the <code>=</code> and then reference the existing column and whatever additional conditions you would like on the right. In the example below, the existing population variable “pop” is converted to a value that shows population in millions.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>new_cols_df <span class="op">=</span> country_metrics</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>new_cols_df[<span class="st">'pop_millions'</span>] <span class="op">=</span> new_cols_df[<span class="st">'pop'</span>]<span class="op">/</span><span class="dv">1000000</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>new_cols_df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
      <th>pop_millions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>8425333.0</td>
      <td>Asia</td>
      <td>28.801</td>
      <td>779.445314</td>
      <td>8.425333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>9240934.0</td>
      <td>Asia</td>
      <td>30.332</td>
      <td>820.853030</td>
      <td>9.240934</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><br> Another way is to call the pandas function <code>apply()</code> in which other, more complicated functions can be passed for a given column. This could be a complicated mathematical formula, a function acting on strings or dates, or any other function that cannot be represented by a simple multiplication or division. In the example below, the <code>len()</code> function is applied to each row in the “country” column and a new column with the number of characters for that row is returned:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>new_cols_df[<span class="st">'country_name_chars'</span>] <span class="op">=</span> new_cols_df.country.<span class="bu">apply</span>(<span class="bu">len</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>new_cols_df.sample(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
      <th>pop_millions</th>
      <th>country_name_chars</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>89</th>
      <td>Bahrain</td>
      <td>1977</td>
      <td>297410.0</td>
      <td>Asia</td>
      <td>65.593</td>
      <td>19340.101960</td>
      <td>0.297410</td>
      <td>7</td>
    </tr>
    <tr>
      <th>433</th>
      <td>Dominican Republic</td>
      <td>1957</td>
      <td>2923186.0</td>
      <td>Americas</td>
      <td>49.828</td>
      <td>1544.402995</td>
      <td>2.923186</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1662</th>
      <td>West Bank and Gaza</td>
      <td>1982</td>
      <td>1425876.0</td>
      <td>Asia</td>
      <td>64.406</td>
      <td>4336.032082</td>
      <td>1.425876</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1037</th>
      <td>Mozambique</td>
      <td>1977</td>
      <td>11127868.0</td>
      <td>Africa</td>
      <td>42.495</td>
      <td>502.319733</td>
      <td>11.127868</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1207</th>
      <td>Peru</td>
      <td>1987</td>
      <td>20195924.0</td>
      <td>Americas</td>
      <td>64.134</td>
      <td>6360.943444</td>
      <td>20.195924</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><br> There is also a special python function called <code>lambda</code>. It is known as an anonymous function, appears in a single line of code, and is not given a name other than lambda. It can take any number of arguments in an expression.</p>
<p>The <code>.assign()</code> method looks at this expression with lambda in it and returns the value it is asked to do and assigns it to the variable name given it. This is how it comes all together to give us actual GDP for each row in our dataframe:</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>GDP_df <span class="op">=</span> new_cols_df.assign(GDP<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">'pop'</span>] <span class="op">*</span> x[<span class="st">'gdpPercap'</span>])</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>GDP_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
      <th>pop_millions</th>
      <th>country_name_chars</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>8425333.0</td>
      <td>Asia</td>
      <td>28.801</td>
      <td>779.445314</td>
      <td>8.425333</td>
      <td>11</td>
      <td>6.567086e+09</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>9240934.0</td>
      <td>Asia</td>
      <td>30.332</td>
      <td>820.853030</td>
      <td>9.240934</td>
      <td>11</td>
      <td>7.585449e+09</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>1962</td>
      <td>10267083.0</td>
      <td>Asia</td>
      <td>31.997</td>
      <td>853.100710</td>
      <td>10.267083</td>
      <td>11</td>
      <td>8.758856e+09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>1967</td>
      <td>11537966.0</td>
      <td>Asia</td>
      <td>34.020</td>
      <td>836.197138</td>
      <td>11.537966</td>
      <td>11</td>
      <td>9.648014e+09</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>1972</td>
      <td>13079460.0</td>
      <td>Asia</td>
      <td>36.088</td>
      <td>739.981106</td>
      <td>13.079460</td>
      <td>11</td>
      <td>9.678553e+09</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>So now we can see the newly created column “GDP” and see the value for each country in our new object. Notice that the GDP data is in scientific notation (i.e.&nbsp;the decimal number times x number of zeros), so it’s a bit hard to read. If we wanted readers to consume that data we would go ahead and change the data type for it. But for current purposes we’ll leave that alone.</p>
<p><br></p>
</section>
<section id="joining-datasets-together" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="joining-datasets-together"><span class="header-section-number">6.7</span> Joining datasets together</h2>
<p>One of the most important tasks in data analysis is to be able to join multiple datasets together. With pandas, there are functions called <code>.merge()</code> and <code>.join()</code> that are similar to each other. As <code>.merge()</code> is perhaps the more used, intuitive, and powerful of the two, we will introduce that method in this tutorial in some depth. There is also a cool function called <code>.concat()</code> that will be introduced below as well.</p>
<p>But first, let’s get a second file that gives us country size in square kilometers by country. We will use this data to put together with our <code>country_metrics</code> dataframe.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>country_size_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span>\</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ds-intro-to-python/main/data/countrysize.csv"</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>country_size <span class="op">=</span> pd.read_csv(country_size_url, encoding<span class="op">=</span> <span class="st">'unicode_escape'</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>country_size.info()</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>country_size.sample(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 235 entries, 0 to 234
Data columns (total 2 columns):
 #   Column           Non-Null Count  Dtype 
---  ------           --------------  ----- 
 0   nation           235 non-null    object
 1   area_square_kms  235 non-null    int64 
dtypes: int64(1), object(1)
memory usage: 3.8+ KB</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>nation</th>
      <th>area_square_kms</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>131</th>
      <td>Estonia</td>
      <td>45227</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Senegal</td>
      <td>196722</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Ok, this <code>country_size</code> dataset looks like we expect - a list of countries alongside the land size of that country in square kilometers. There are some omissions in this list - not all countries in our <code>country_metrics</code> dataset are present in this <code>country_size</code> object. But for our present purposes this is ok. We just want to get that square kilometers data into a combined dataset and it is sufficient for that.</p>
<p>Essentially what we want to do is a classic “left-join” operation of the sort in the diagram below. Conceptually, the <code>country_metrics</code> dataset is like the purple table and the <code>country_size</code> dataset is like the red one.</p>
<center>
<img src="images/exploring-data-structures/join_types.png" width="70%" style="margin:auto">
<p style="text-align: center">
Types of Joins
</p>
<br>
</center>
<p>The <code>.merge()</code> method <a href="https://pandas.pydata.org/docs/reference/api/pandas.merge.html">(with reference material available here)</a> works similarly to how table joining works in <code>SQL</code> or how the <code>VLOOKUP</code> function works in Excel. One needs to specify both dataframes, the key variables on which to join them, and the kind of join desired.</p>
<p>So let’s look at the example below to see how it all comes together in code.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>combined_df <span class="op">=</span> country_metrics.merge(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    country_size, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    left_on<span class="op">=</span><span class="st">'country'</span>, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    right_on<span class="op">=</span><span class="st">'nation'</span>, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">'left'</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>combined_df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
      <th>pop_millions</th>
      <th>country_name_chars</th>
      <th>nation</th>
      <th>area_square_kms</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>8425333.0</td>
      <td>Asia</td>
      <td>28.801</td>
      <td>779.445314</td>
      <td>8.425333</td>
      <td>11</td>
      <td>Afghanistan</td>
      <td>652230.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>9240934.0</td>
      <td>Asia</td>
      <td>30.332</td>
      <td>820.853030</td>
      <td>9.240934</td>
      <td>11</td>
      <td>Afghanistan</td>
      <td>652230.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><br> When you run the code above you will notice that both the <code>nation</code> key column and the <code>area_square_kms</code> column have been joined together in the new <code>combined_df</code> object. One can keep that nation column in there for control purposes, or it can be removed by using the <code>.drop()</code> method we used earlier:</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>combined_df <span class="op">=</span> combined_df.drop(<span class="st">'nation'</span>, axis<span class="op">=</span><span class="dv">1</span>) </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>combined_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>pop</th>
      <th>continent</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
      <th>pop_millions</th>
      <th>country_name_chars</th>
      <th>area_square_kms</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>8425333.0</td>
      <td>Asia</td>
      <td>28.801</td>
      <td>779.445314</td>
      <td>8.425333</td>
      <td>11</td>
      <td>652230.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>9240934.0</td>
      <td>Asia</td>
      <td>30.332</td>
      <td>820.853030</td>
      <td>9.240934</td>
      <td>11</td>
      <td>652230.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>1962</td>
      <td>10267083.0</td>
      <td>Asia</td>
      <td>31.997</td>
      <td>853.100710</td>
      <td>10.267083</td>
      <td>11</td>
      <td>652230.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>1967</td>
      <td>11537966.0</td>
      <td>Asia</td>
      <td>34.020</td>
      <td>836.197138</td>
      <td>11.537966</td>
      <td>11</td>
      <td>652230.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>1972</td>
      <td>13079460.0</td>
      <td>Asia</td>
      <td>36.088</td>
      <td>739.981106</td>
      <td>13.079460</td>
      <td>11</td>
      <td>652230.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Another innovative way to put “merge” data together in pandas is with the <code>.concat()</code> function. Conceptually you can think if it like “stacking” two data objects on top of each other or side-by-side as shown in the diagram below.</p>
<center>
<img src="images/exploring-data-structures/concat.png" width="70%" style="margin:auto">
<p style="text-align: center">
Ways to stack data
</p>
<br>
</center>
<p>To illustrate, let’s fetch two simple dataframes. Each contains the average scores for three subjects by year for two separate schools.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>school1_url  <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span>\</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ds-intro-to-python/main/data/school1.csv"</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>school2_url  <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span>\</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ds-intro-to-python/main/data/school2.csv"</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>school1_df <span class="op">=</span> pd.read_csv(school1_url)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>school2_df <span class="op">=</span> pd.read_csv(school2_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s take a quick look at the two dataframes.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>school1_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Subject</th>
      <th>Avg Score 2018</th>
      <th>Avg Score 2019</th>
      <th>Avg Score 2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Science</td>
      <td>67</td>
      <td>88</td>
      <td>89</td>
    </tr>
    <tr>
      <th>1</th>
      <td>English</td>
      <td>86</td>
      <td>67</td>
      <td>77</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Math</td>
      <td>84</td>
      <td>73</td>
      <td>75</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>school2_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Subject</th>
      <th>Avg Score 2018</th>
      <th>Avg Score 2019</th>
      <th>Avg Score 2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Science</td>
      <td>32</td>
      <td>88</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>English</td>
      <td>88</td>
      <td>44</td>
      <td>77</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Math</td>
      <td>84</td>
      <td>73</td>
      <td>53</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We call <code>.concat()</code> and pass in the objects that we want to stack vertically. This is a similiar operation to <code>union</code> in <code>SQL</code>.</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>vertical_stack_df <span class="op">=</span> pd.concat([school1_df, school2_df])</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>vertical_stack_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Subject</th>
      <th>Avg Score 2018</th>
      <th>Avg Score 2019</th>
      <th>Avg Score 2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Science</td>
      <td>67</td>
      <td>88</td>
      <td>89</td>
    </tr>
    <tr>
      <th>1</th>
      <td>English</td>
      <td>86</td>
      <td>67</td>
      <td>77</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Math</td>
      <td>84</td>
      <td>73</td>
      <td>75</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Science</td>
      <td>32</td>
      <td>88</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>English</td>
      <td>88</td>
      <td>44</td>
      <td>77</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Math</td>
      <td>84</td>
      <td>73</td>
      <td>53</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>It is also possible to stack the data horizontally. Here it is necessary to specify the columnar axis (axis=1) as the default setting is for rows (axis=0).</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>horizontal_stack <span class="op">=</span> pd.concat([school1_df, school2_df], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>horizontal_stack</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Subject</th>
      <th>Avg Score 2018</th>
      <th>Avg Score 2019</th>
      <th>Avg Score 2020</th>
      <th>Subject</th>
      <th>Avg Score 2018</th>
      <th>Avg Score 2019</th>
      <th>Avg Score 2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Science</td>
      <td>67</td>
      <td>88</td>
      <td>89</td>
      <td>Science</td>
      <td>32</td>
      <td>88</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>English</td>
      <td>86</td>
      <td>67</td>
      <td>77</td>
      <td>English</td>
      <td>88</td>
      <td>44</td>
      <td>77</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Math</td>
      <td>84</td>
      <td>73</td>
      <td>75</td>
      <td>Math</td>
      <td>84</td>
      <td>73</td>
      <td>53</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>This introduction only scratches the surface of how to leverage this way of joining datasets together. But it can be a powerful tool in the toolkit for the right use case. <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html">More detail found here.</a></p>
<p><br></p>
</section>
<section id="grouping-and-summarizing" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="grouping-and-summarizing"><span class="header-section-number">6.8</span> Grouping and summarizing</h2>
<p>Sometimes of course one would prefer to group rows together for the purpose of summarizing them in various ways.</p>
<p>In pandas, we can accomplish this using the <code>.groupby()</code> method. A <code>.groupby()</code> operation involves some combination of splitting the object, applying a function, and combining the results. It is used together with one or more aggregation functions:</p>
<ul>
<li><code>count()</code>: Total number of items</li>
<li><code>first()</code>, <code>last()</code>: First and last item</li>
<li><code>mean()</code>, <code>median()</code>: Mean and median</li>
<li><code>min()</code>, <code>max()</code>: Minimum and maximum</li>
<li><code>std()</code>, <code>var()</code>: Standard deviation and variance</li>
<li><code>mad()</code>: Mean absolute deviation</li>
<li><code>prod()</code>: Product of all items</li>
<li><code>sum()</code>: Sum of all items</li>
</ul>
<p>First let us look at a simple example where we want to get the mean life expectancy for each continent in the data. To do this, we would use the <code>groupby()</code> function to call the appropriate segment (i.e.&nbsp;continent), metric (i.e.&nbsp;lifeExp), and type of aggregation (i.e.&nbsp;mean):</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>simple_mean <span class="op">=</span> country_metrics.groupby(<span class="st">'continent'</span>).lifeExp.mean()</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>simple_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>continent
Africa      48.865330
Americas    64.658737
Asia        60.064903
Europe      71.903686
Oceania     74.326208
Name: lifeExp, dtype: float64</code></pre>
</div>
</div>
<p>Fortunately, if we want to look at several aggregations at once, we can do that too. To extend our example above, we would specify the “continent” column in the <code>.groupby()</code> function, then pass additional aggregation functions (in our case, we will add “mean”, “min”, and “max”) as a dictionary within the <code>.agg()</code> function.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Recall: Dictionaries in Python
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember that a dictionary in Python language is a particular type of data structure that contains a collection of <code>key</code>: <code>value</code> pairs. It is analogous to a regular word dictionary you are familiar with which is a collection of words to their meanings. Python dictionaries allow us to associate a value to a unique key, and then to quickly access this value. They are generally created within curly braces <code>{}</code> and have a specified key name and value (e.g.&nbsp;basic form for a python dictionary <code>{"key1": "value1"}</code>)</p>
</div>
</div>
<p><br> This dictionary takes the column that we are aggregating - in this case life expectancy - as a key and a <strong>list</strong> of aggregation functions as its value. We also add a line of code that gives each of the columns a new name with the <code>.columns()</code> function.</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>grouped_single <span class="op">=</span> country_metrics.groupby(<span class="st">'continent'</span>) <span class="op">\</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">'lifeExp'</span>: [<span class="st">'mean'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>]})</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>grouped_single.columns <span class="op">=</span> [<span class="st">'lifeExp_mean'</span>, <span class="st">'lifeExp_min'</span>, <span class="st">'lifeExp_max'</span>]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>grouped_single</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>lifeExp_mean</th>
      <th>lifeExp_min</th>
      <th>lifeExp_max</th>
    </tr>
    <tr>
      <th>continent</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Africa</th>
      <td>48.865330</td>
      <td>23.599</td>
      <td>76.442</td>
    </tr>
    <tr>
      <th>Americas</th>
      <td>64.658737</td>
      <td>37.579</td>
      <td>80.653</td>
    </tr>
    <tr>
      <th>Asia</th>
      <td>60.064903</td>
      <td>28.801</td>
      <td>82.603</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>71.903686</td>
      <td>43.585</td>
      <td>81.757</td>
    </tr>
    <tr>
      <th>Oceania</th>
      <td>74.326208</td>
      <td>69.120</td>
      <td>81.235</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>If you look closely at <code>grouped_single</code> you see that the variable “continent” is on a different line than are the columns that are aggregated. That is because continent in this instance is actually an index and not a column.</p>
<p>We can nest additional “groups within groups” by creating a <em>list</em> of column names and passing them to the <code>.groupby()</code> function instead of passing a single value.</p>
<p>The example below adds more granularity with the introduction of ‘country’ and the creation of a list to hold both ‘continent’ and ‘country’.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>grouped_multiple <span class="op">=</span> country_metrics.groupby(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'continent'</span>, <span class="st">'country'</span>]).agg({<span class="st">'pop'</span>: [<span class="st">'mean'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>]}</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>grouped_multiple.columns <span class="op">=</span> [<span class="st">'pop_mean'</span>, <span class="st">'pop_min'</span>, <span class="st">'pop_max'</span>]</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>grouped_multiple.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>pop_mean</th>
      <th>pop_min</th>
      <th>pop_max</th>
    </tr>
    <tr>
      <th>continent</th>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="10" valign="top">Africa</th>
      <th>Algeria</th>
      <td>1.987541e+07</td>
      <td>9279525.0</td>
      <td>33333216.0</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>7.309390e+06</td>
      <td>4232095.0</td>
      <td>12420476.0</td>
    </tr>
    <tr>
      <th>Benin</th>
      <td>4.017497e+06</td>
      <td>1738315.0</td>
      <td>8078314.0</td>
    </tr>
    <tr>
      <th>Botswana</th>
      <td>9.711862e+05</td>
      <td>442308.0</td>
      <td>1639131.0</td>
    </tr>
    <tr>
      <th>Burkina Faso</th>
      <td>7.548677e+06</td>
      <td>4469979.0</td>
      <td>14326203.0</td>
    </tr>
    <tr>
      <th>Burundi</th>
      <td>4.651608e+06</td>
      <td>2445618.0</td>
      <td>8390505.0</td>
    </tr>
    <tr>
      <th>Cameroon</th>
      <td>9.816648e+06</td>
      <td>5009067.0</td>
      <td>17696293.0</td>
    </tr>
    <tr>
      <th>Central African Republic</th>
      <td>2.560963e+06</td>
      <td>1291695.0</td>
      <td>4369038.0</td>
    </tr>
    <tr>
      <th>Chad</th>
      <td>5.329256e+06</td>
      <td>2682462.0</td>
      <td>10238807.0</td>
    </tr>
    <tr>
      <th>Comoros</th>
      <td>3.616839e+05</td>
      <td>153936.0</td>
      <td>710960.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Again will notice that this dataframe looks a little different than some others we have seen in that there are blank spaces below each grouped value of continent in that index. This object is a multi-indexed dataframe. It presents the data nicely to consume visually, but it is not ideal to work with if you want to do further manipulation.</p>
<p>This is likely again a good time to use the <code>reset_index()</code> function. This is a step that resets the index to an integer based index and re-creates a non-indexed pandas dataframe.</p>
<p>The code block below is identical to the one we just ran except for the line of code that resets the index:</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>grouped_multiple <span class="op">=</span> country_metrics.groupby(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'continent'</span>, <span class="st">'country'</span>]).agg({<span class="st">'pop'</span>: [<span class="st">'mean'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>]}</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>grouped_multiple.columns <span class="op">=</span> [<span class="st">'pop_mean'</span>, <span class="st">'pop_min'</span>, <span class="st">'pop_max'</span>]</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>grouped_multiple <span class="op">=</span> grouped_multiple.reset_index()  <span class="co"># resets the index</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>grouped_multiple.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>continent</th>
      <th>country</th>
      <th>pop_mean</th>
      <th>pop_min</th>
      <th>pop_max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Africa</td>
      <td>Algeria</td>
      <td>1.987541e+07</td>
      <td>9279525.0</td>
      <td>33333216.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Africa</td>
      <td>Angola</td>
      <td>7.309390e+06</td>
      <td>4232095.0</td>
      <td>12420476.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Africa</td>
      <td>Benin</td>
      <td>4.017497e+06</td>
      <td>1738315.0</td>
      <td>8078314.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Africa</td>
      <td>Botswana</td>
      <td>9.711862e+05</td>
      <td>442308.0</td>
      <td>1639131.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Africa</td>
      <td>Burkina Faso</td>
      <td>7.548677e+06</td>
      <td>4469979.0</td>
      <td>14326203.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Africa</td>
      <td>Burundi</td>
      <td>4.651608e+06</td>
      <td>2445618.0</td>
      <td>8390505.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Africa</td>
      <td>Cameroon</td>
      <td>9.816648e+06</td>
      <td>5009067.0</td>
      <td>17696293.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Africa</td>
      <td>Central African Republic</td>
      <td>2.560963e+06</td>
      <td>1291695.0</td>
      <td>4369038.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Africa</td>
      <td>Chad</td>
      <td>5.329256e+06</td>
      <td>2682462.0</td>
      <td>10238807.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Africa</td>
      <td>Comoros</td>
      <td>3.616839e+05</td>
      <td>153936.0</td>
      <td>710960.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>This looks more like the structure of the dataframes we know already and will be easier to manipulate further.</p>
<div class="callout-warning callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Challenge 4
</div>
</div>
<div class="callout-body-container callout-body">
<p>You would like to summarize population as well as life expectancy by year, grouped by continent. Pick some aggregations that would make sense to look at for this task. Don’t worry about re-setting the index or about creating new labels for the result.</p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution to Challenge 4
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Using what we learned about how to select rows, we should limit the dataframe to rows where the year is greater than or equal to 1992. Next we should create a multi-column call to the <code>.groupby()</code> function. Finally we should select some aggregations such as mean and max among others could make sense here.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>challenge4_df <span class="op">=</span> country_metrics.groupby(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'continent'</span>, <span class="st">'year'</span>]).agg({<span class="st">'pop'</span> : [<span class="st">'mean'</span>, <span class="st">'max'</span>], <span class="st">'lifeExp'</span> : [<span class="st">'mean'</span>, <span class="st">'max'</span>]}</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>challenge4_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">pop</th>
      <th colspan="2" halign="left">lifeExp</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
      <th>max</th>
      <th>mean</th>
      <th>max</th>
    </tr>
    <tr>
      <th>continent</th>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="12" valign="top">Africa</th>
      <th>1952</th>
      <td>4.570010e+06</td>
      <td>3.311910e+07</td>
      <td>39.135500</td>
      <td>52.724</td>
    </tr>
    <tr>
      <th>1957</th>
      <td>5.093033e+06</td>
      <td>3.717334e+07</td>
      <td>41.266346</td>
      <td>58.089</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>5.702247e+06</td>
      <td>4.187135e+07</td>
      <td>43.319442</td>
      <td>60.246</td>
    </tr>
    <tr>
      <th>1967</th>
      <td>6.447875e+06</td>
      <td>4.728775e+07</td>
      <td>45.334538</td>
      <td>61.557</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>7.305376e+06</td>
      <td>5.374008e+07</td>
      <td>47.450942</td>
      <td>64.274</td>
    </tr>
    <tr>
      <th>1977</th>
      <td>8.328097e+06</td>
      <td>6.220917e+07</td>
      <td>49.580423</td>
      <td>67.064</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>9.602857e+06</td>
      <td>7.303938e+07</td>
      <td>51.592865</td>
      <td>69.885</td>
    </tr>
    <tr>
      <th>1987</th>
      <td>1.105450e+07</td>
      <td>8.155152e+07</td>
      <td>53.344788</td>
      <td>71.913</td>
    </tr>
    <tr>
      <th>1992</th>
      <td>1.267464e+07</td>
      <td>9.336424e+07</td>
      <td>53.629577</td>
      <td>73.615</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>1.430448e+07</td>
      <td>1.062078e+08</td>
      <td>53.598269</td>
      <td>74.772</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>1.603315e+07</td>
      <td>1.199013e+08</td>
      <td>53.325231</td>
      <td>75.744</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>1.787576e+07</td>
      <td>1.350312e+08</td>
      <td>54.806038</td>
      <td>76.442</td>
    </tr>
    <tr>
      <th rowspan="12" valign="top">Americas</th>
      <th>1952</th>
      <td>1.380610e+07</td>
      <td>1.575530e+08</td>
      <td>53.279840</td>
      <td>68.750</td>
    </tr>
    <tr>
      <th>1957</th>
      <td>1.547816e+07</td>
      <td>1.719840e+08</td>
      <td>55.960280</td>
      <td>69.960</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>1.733081e+07</td>
      <td>1.865380e+08</td>
      <td>58.398760</td>
      <td>71.300</td>
    </tr>
    <tr>
      <th>1967</th>
      <td>1.922986e+07</td>
      <td>1.987120e+08</td>
      <td>60.410920</td>
      <td>72.130</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>2.117537e+07</td>
      <td>2.098960e+08</td>
      <td>62.394920</td>
      <td>72.880</td>
    </tr>
    <tr>
      <th>1977</th>
      <td>2.312271e+07</td>
      <td>2.202390e+08</td>
      <td>64.391560</td>
      <td>74.210</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>2.521164e+07</td>
      <td>2.321878e+08</td>
      <td>66.228840</td>
      <td>75.760</td>
    </tr>
    <tr>
      <th>1987</th>
      <td>2.731016e+07</td>
      <td>2.428035e+08</td>
      <td>68.090720</td>
      <td>76.860</td>
    </tr>
    <tr>
      <th>1992</th>
      <td>2.957096e+07</td>
      <td>2.568942e+08</td>
      <td>69.568360</td>
      <td>77.950</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>3.187602e+07</td>
      <td>2.729118e+08</td>
      <td>71.150480</td>
      <td>78.610</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>3.399091e+07</td>
      <td>2.876755e+08</td>
      <td>72.422040</td>
      <td>79.770</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>3.595485e+07</td>
      <td>3.011399e+08</td>
      <td>73.608120</td>
      <td>80.653</td>
    </tr>
    <tr>
      <th rowspan="12" valign="top">Asia</th>
      <th>1952</th>
      <td>4.228356e+07</td>
      <td>5.562635e+08</td>
      <td>46.314394</td>
      <td>65.390</td>
    </tr>
    <tr>
      <th>1957</th>
      <td>4.735699e+07</td>
      <td>6.374080e+08</td>
      <td>49.318544</td>
      <td>67.840</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>5.140476e+07</td>
      <td>6.657700e+08</td>
      <td>51.563223</td>
      <td>69.390</td>
    </tr>
    <tr>
      <th>1967</th>
      <td>5.774736e+07</td>
      <td>7.545500e+08</td>
      <td>54.663640</td>
      <td>71.430</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>6.518098e+07</td>
      <td>8.620300e+08</td>
      <td>57.319269</td>
      <td>73.420</td>
    </tr>
    <tr>
      <th>1977</th>
      <td>7.225799e+07</td>
      <td>9.434550e+08</td>
      <td>59.610556</td>
      <td>75.380</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>7.909502e+07</td>
      <td>1.000281e+09</td>
      <td>62.617939</td>
      <td>77.110</td>
    </tr>
    <tr>
      <th>1987</th>
      <td>8.700669e+07</td>
      <td>1.084035e+09</td>
      <td>64.851182</td>
      <td>78.670</td>
    </tr>
    <tr>
      <th>1992</th>
      <td>9.494825e+07</td>
      <td>1.164970e+09</td>
      <td>66.537212</td>
      <td>79.360</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>1.025238e+08</td>
      <td>1.230075e+09</td>
      <td>68.020515</td>
      <td>80.690</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>1.091455e+08</td>
      <td>1.280400e+09</td>
      <td>69.233879</td>
      <td>82.000</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>1.155138e+08</td>
      <td>1.318683e+09</td>
      <td>70.728485</td>
      <td>82.603</td>
    </tr>
    <tr>
      <th rowspan="12" valign="top">Europe</th>
      <th>1952</th>
      <td>1.393736e+07</td>
      <td>6.914595e+07</td>
      <td>64.408500</td>
      <td>72.670</td>
    </tr>
    <tr>
      <th>1957</th>
      <td>1.459635e+07</td>
      <td>7.101907e+07</td>
      <td>66.703067</td>
      <td>73.470</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>1.534517e+07</td>
      <td>7.373912e+07</td>
      <td>68.539233</td>
      <td>73.680</td>
    </tr>
    <tr>
      <th>1967</th>
      <td>1.603930e+07</td>
      <td>7.636845e+07</td>
      <td>69.737600</td>
      <td>74.160</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>1.668784e+07</td>
      <td>7.871709e+07</td>
      <td>70.775033</td>
      <td>74.720</td>
    </tr>
    <tr>
      <th>1977</th>
      <td>1.723882e+07</td>
      <td>7.816077e+07</td>
      <td>71.937767</td>
      <td>76.110</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>1.770890e+07</td>
      <td>7.833527e+07</td>
      <td>72.806400</td>
      <td>76.990</td>
    </tr>
    <tr>
      <th>1987</th>
      <td>1.810314e+07</td>
      <td>7.771830e+07</td>
      <td>73.642167</td>
      <td>77.410</td>
    </tr>
    <tr>
      <th>1992</th>
      <td>1.860476e+07</td>
      <td>8.059776e+07</td>
      <td>74.440100</td>
      <td>78.770</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>1.896480e+07</td>
      <td>8.201107e+07</td>
      <td>75.505167</td>
      <td>79.390</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>1.927413e+07</td>
      <td>8.235067e+07</td>
      <td>76.700600</td>
      <td>80.620</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>1.953662e+07</td>
      <td>8.240100e+07</td>
      <td>77.648600</td>
      <td>81.757</td>
    </tr>
    <tr>
      <th rowspan="12" valign="top">Oceania</th>
      <th>1952</th>
      <td>5.343003e+06</td>
      <td>8.691212e+06</td>
      <td>69.255000</td>
      <td>69.390</td>
    </tr>
    <tr>
      <th>1957</th>
      <td>5.970988e+06</td>
      <td>9.712569e+06</td>
      <td>70.295000</td>
      <td>70.330</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>6.641759e+06</td>
      <td>1.079497e+07</td>
      <td>71.085000</td>
      <td>71.240</td>
    </tr>
    <tr>
      <th>1967</th>
      <td>7.300207e+06</td>
      <td>1.187226e+07</td>
      <td>71.310000</td>
      <td>71.520</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>8.053050e+06</td>
      <td>1.317700e+07</td>
      <td>71.910000</td>
      <td>71.930</td>
    </tr>
    <tr>
      <th>1977</th>
      <td>8.619500e+06</td>
      <td>1.407410e+07</td>
      <td>72.855000</td>
      <td>73.490</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>9.197425e+06</td>
      <td>1.518420e+07</td>
      <td>74.290000</td>
      <td>74.740</td>
    </tr>
    <tr>
      <th>1987</th>
      <td>9.787208e+06</td>
      <td>1.625725e+07</td>
      <td>75.320000</td>
      <td>76.320</td>
    </tr>
    <tr>
      <th>1992</th>
      <td>1.045983e+07</td>
      <td>1.748198e+07</td>
      <td>76.945000</td>
      <td>77.560</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>1.112072e+07</td>
      <td>1.856524e+07</td>
      <td>78.190000</td>
      <td>78.830</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>1.172741e+07</td>
      <td>1.954679e+07</td>
      <td>79.740000</td>
      <td>80.370</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>1.227497e+07</td>
      <td>2.043418e+07</td>
      <td>80.719500</td>
      <td>81.235</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<p>By now you should be able to select the rows and columns, join together dataframes, and create some basic summarizations of data. The next section will look at some of the more sophisticated and elegant tools for understanding and presenting your data. But the building blocks you have just learned about are the meat and potatoes of data analysis in the python world.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./12_cleaning_it_up.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Cleaning Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./22_graphical_depictions_of_data.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Graphical Depictions of Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Introduction to Data Science using Python was written by <br> Lindsay Forestell and Stuart Hemerling</div>   
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="./license.qmd">License</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://bcgov.github.io/ds-intro-to-python/index.html">Python for Data Science Course</a>
  </li>  
</ul>
      </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>