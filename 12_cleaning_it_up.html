<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Cleaning Data – Introduction to Data Science using Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./21_exploring_data_structures.html" rel="next">
<link href="./11_getting_data_with_pandas.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-92e2dd4f4c7daf58452f04a50b571cde.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-840d0bcdd202e39593fd3aec26358f27.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./BCID_H_rgb_rev.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-introduction-to-python" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Introduction to Python</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-introduction-to-python">    
        <li>
    <a class="dropdown-item" href="./00_introduction_to_python.html">
 <span class="dropdown-text">Getting Up and Running</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01_working_with_code.html">
 <span class="dropdown-text">Working with Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_core_data_structure_concepts.html">
 <span class="dropdown-text">Core Concepts</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-get-and-clean-data" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Get and Clean Data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-get-and-clean-data">    
        <li>
    <a class="dropdown-item" href="./11_getting_data_with_pandas.html">
 <span class="dropdown-text">Getting Data with Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./12_cleaning_it_up.html">
 <span class="dropdown-text">Cleaning Data with Pandas</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-understand-and-analyze-data" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Understand and Analyze Data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-understand-and-analyze-data">    
        <li>
    <a class="dropdown-item" href="./21_exploring_data_structures.html">
 <span class="dropdown-text">Exploring Data Structures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./22_graphical_depictions_of_data.html">
 <span class="dropdown-text">Graphical Depictions of Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-advanced-topics" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Advanced Topics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-advanced-topics">    
        <li>
    <a class="dropdown-item" href="./31_bcdata.html">
 <span class="dropdown-text">bcdata package</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./32_advanced_pandas.html">
 <span class="dropdown-text">Advanced Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./33_create_reports.html">
 <span class="dropdown-text">Creating Reports</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./34_machine_learning.html">
 <span class="dropdown-text">Machine Learning</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./references.html"> 
<span class="menu-text">References</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/bcgov/ds-intro-to-python" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12_cleaning_it_up.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Cleaning Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./cover.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_introduction_to_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Up and Running</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_working_with_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Working with Code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_core_data_structure_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Core Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_getting_data_with_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Getting Data With Pandas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_cleaning_it_up.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Cleaning Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_exploring_data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Exploring Data Structures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_graphical_depictions_of_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Graphical Depictions of Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31_bcdata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to bcdata</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32_advanced_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Advanced Pandas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33_create_reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Creating Reports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34_machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cleaning-and-data-science" id="toc-cleaning-and-data-science" class="nav-link active" data-scroll-target="#cleaning-and-data-science"><span class="header-section-number">5.1</span> Cleaning and data science</a></li>
  <li><a href="#dealing-with-missing-data" id="toc-dealing-with-missing-data" class="nav-link" data-scroll-target="#dealing-with-missing-data"><span class="header-section-number">5.2</span> Dealing with Missing Data</a>
  <ul>
  <li><a href="#locating-missing-data" id="toc-locating-missing-data" class="nav-link" data-scroll-target="#locating-missing-data">Locating Missing Data</a></li>
  <li><a href="#dropping-rows-and-columns" id="toc-dropping-rows-and-columns" class="nav-link" data-scroll-target="#dropping-rows-and-columns">Dropping rows and columns</a></li>
  <li><a href="#saving-the-dataframe-inplace" id="toc-saving-the-dataframe-inplace" class="nav-link" data-scroll-target="#saving-the-dataframe-inplace">Saving the dataframe “inplace”</a></li>
  <li><a href="#filling-in-missing-data" id="toc-filling-in-missing-data" class="nav-link" data-scroll-target="#filling-in-missing-data">Filling in missing data</a></li>
  </ul></li>
  <li><a href="#modifying-existing-data" id="toc-modifying-existing-data" class="nav-link" data-scroll-target="#modifying-existing-data"><span class="header-section-number">5.3</span> Modifying existing data</a>
  <ul>
  <li><a href="#cleaning-the-header-row" id="toc-cleaning-the-header-row" class="nav-link" data-scroll-target="#cleaning-the-header-row">Cleaning the header row</a></li>
  <li><a href="#ensuring-the-right-datatypes" id="toc-ensuring-the-right-datatypes" class="nav-link" data-scroll-target="#ensuring-the-right-datatypes">Ensuring the right datatypes</a></li>
  <li><a href="#recoding-values" id="toc-recoding-values" class="nav-link" data-scroll-target="#recoding-values">Recoding values</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/bcgov/ds-intro-to-python/blob/main/12_cleaning_it_up.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/bcgov/ds-intro-to-python/edit/main/12_cleaning_it_up.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/bcgov/ds-intro-to-python/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Cleaning Data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="cleaning-and-data-science" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="cleaning-and-data-science"><span class="header-section-number">5.1</span> Cleaning and data science</h2>
<p>Imagine you have finally gotten that dataset that you need to work with to answer those questions you’ve been asked to clear up. But wait! Before you get started in earnest working away with generating insights, it is important that you take a closer look at the “quality” of the data.</p>
<p>There is much to look at and consider when it comes to the topic of data cleaning. You probably have heard it said that 80% (or some high percentage) of a data scientist’s time is spent cleaning data, that is, putting it in a form that will better suit its downstream uses.</p>
<p>Not surprisingly, data cleaning is a topic difficult to cover systematically in an introductory course.</p>
<center>
<img src="images/cleaning-it-up/73mtqx.gif" width="35%" style="margin:auto">
<p style="text-align: center">
It’s not so bad, promise!
</p>
</center>
<p>So in this tutorial we will focus on a few cleaning techniques - with pandas - that are likely going to be leveraged over and over again when you work with data in python.</p>
<ul>
<li>How to identify and clean up missing data</li>
<li>When and how to change datatypes</li>
<li>When and how to modify values in your dataset</li>
</ul>
</section>
<section id="dealing-with-missing-data" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="dealing-with-missing-data"><span class="header-section-number">5.2</span> Dealing with Missing Data</h2>
<p>One of the most common issues in data cleaning has to do with data that is missing from your dataset. Most data, even data that is meticulously collected and managed, is likely to have empty cells. Empty data can be harmless, or it can represent a challenge to you, depending on what you need your data to do once you have finished working with it.</p>
<p>The best way to learn about these concepts is to see them in action with real (or real-ish) data! Before we get started with fetching the data, let’s go ahead and get pandas for today’s session.</p>
<div id="7dc04c74" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import pandas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, imagine we had our own online streaming service. We have access to some data that will help us predict what our users would like to see. To fetch it, run the code below:</p>
<div id="60a8affb" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mr <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span> \</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ds-intro-to-python/main/data/movieratings.csv"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> pd.read_csv(mr)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Floriana</td>
<td>NaN</td>
<td>5.0</td>
<td>5.0</td>
<td>3.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Raymundo</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Jung</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Kumar</td>
<td>5.0</td>
<td>NaN</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Maria</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This is a 10 row dataframe, with each row containing a movie rater as well as their ratings for selected movies that they have given ratings for. For interpretative purposes, each movie is rated on a 5 point scale, with 5 being super awesome and 1 being dismal. Not every movie is rated by every rater, so several cells are blank. These are the missing data cells and are marked with “NaN”, indicating missing data.</p>
<p>This dataset, while small and made up, exemplifies a classic “recommendation engine” use case problem - there are lots of raters and lots of movies, but an <em>awful lot</em> of missing data. So what one chooses to do with missing data is a key cleaning question.</p>
<section id="locating-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="locating-missing-data">Locating Missing Data</h3>
<p>In pandas, there is a widely used method named <code>isna()</code> which can be applied to a whole dataframe or just to a particular series or column.</p>
<p>Below we apply it to the entire dataframe to get a cell by cell view of whether the cell data is missing or not (True means it is missing, False means it is not):</p>
<div id="25e3dd90" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find the missing values</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>True</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>It is probably helpful to note there is a similar function called <code>isnull()</code> that is an alias for <code>isna()</code>. You may run into both, and both will return the same results. There is also a <code>notna()</code>(<code>notnull()</code>) function, which is the inverse function of <code>isna()</code>(<code>isnull()</code>), returning True for values that are not NA. For simplicity, let’s just stick with <code>isna()</code> in this tutorial.</p>
<p>To get a better summary overview (i.e.&nbsp;one that summarizes with numbers) of how many missing values there are per column, then we need to chain togther a <code>.sum()</code> function to the line of code like so:</p>
<div id="87219954" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">###listing out the missing values in the dataframe for each series</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Rater           0
Star Wars       2
Finding Nemo    5
Forrest Gump    3
Parasite        4
Citizen Kane    4
dtype: int64</code></pre>
</div>
</div>
<p>The reason that this works is because a boolean value of True is represented in pandas by the value of 1, while False is represented by a 0. Therefore, we can apply the <code>sum()</code>method to the dataframe with series being returned that contains the counts of missing items in each column.</p>
<p>Now we see no missing data for Rater, but missing data for each of the movies. For our use case, missing data is a real challenge. With pandas, we can deal with this in many different ways.</p>
</section>
<section id="dropping-rows-and-columns" class="level3">
<h3 class="anchored" data-anchor-id="dropping-rows-and-columns">Dropping rows and columns</h3>
<p>One cleaning option we have is to drop entire rows or columns with missing values in them from the dataframe. The method is called <code>dropna()</code>and takes a number of parameters:</p>
<ul>
<li>axis: {0 or ‘index’, 1 or ‘columns’}, default 0</li>
<li>how: {‘any’, ‘all’}, default ‘any’</li>
<li>subset: column label or sequence of labels</li>
</ul>
<p>Imagine we would like to drop all of the rows with any missing values in them. Since the <code>axis=0</code> and <code>how=any</code> parameters are the defaults, we can write an elegant and simple line of code:</p>
<div id="cc0c311d" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>reduced_rows <span class="op">=</span> movie_ratings.dropna()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>reduced_rows.head(<span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Arthur</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Martina</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Orson</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
<td>5.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We still have three raters who have given us ratings for each movie. The dataset is nice and clean now, although it has come at a pretty big cost, losing seven rows of data! If we go in the other direction, and insert a parameter of <code>how='all'</code>, then we have the opposite problem, with <em>no rows</em> being eliminated (as there were no instances where all of the columns contained missing data for a given row)!</p>
<p>Another option is to use subset to eliminate rows on the basis of whether values are missing in a specified subset. Let’s say we want to have just the rows of data where there is not missing ratings data for the film “Parasite”. We would use <code>subset=</code> parameter and identify the column we want to clean up:</p>
<div id="6a9725ef" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>par_df <span class="op">=</span> movie_ratings.dropna(subset<span class="op">=</span><span class="st">'Parasite'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>par_df.head(<span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Floriana</td>
<td>NaN</td>
<td>5.0</td>
<td>5.0</td>
<td>3.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Jung</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Arthur</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>Marcellus</td>
<td>NaN</td>
<td>NaN</td>
<td>4.0</td>
<td>5.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>Martina</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>Orson</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
<td>5.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We can see that, while there is no NaN in the Parasite column, we can see they are still there sprinkled throughout other columns.</p>
<p>Now what would happen if we applied that same drop logic to all columns?</p>
<div id="56e35d68" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>reduced_cols <span class="op">=</span> movie_ratings.dropna(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>reduced_cols.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Floriana</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Raymundo</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Jung</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Kumar</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Maria</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We see that we pretty much all the movie columns have been removed, as each of these columns had at least one missing value! So be careful when using <code>dropna()</code> as it can be a powerful eraser of data. Whether you should use it or how you should will depend on the downstream uses for your data.</p>
<p><br></p>
</section>
<section id="saving-the-dataframe-inplace" class="level3">
<h3 class="anchored" data-anchor-id="saving-the-dataframe-inplace">Saving the dataframe “inplace”</h3>
<p><code>Inplace</code> is an argument used in different functions such as <code>dropna()</code> that we have just looked at. The default value of this attribute is <code>False</code>, which means whatever the function does to the dataframe, it does so as a <em>copy</em> of the object. When the argument is <code>inplace=True</code>, however, whatever changes are made by the given function are made to the original object <em>inplace</em>, not just to a copy of it!</p>
<p>Let’s look at how this works starting with fetching the data from the source:</p>
<div id="d278f96f" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetching the data to make sure we start again with the original</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mr <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span> \</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ds-intro-to-python/main/data/movieratings.csv"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> pd.read_csv(mr)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Floriana</td>
<td>NaN</td>
<td>5.0</td>
<td>5.0</td>
<td>3.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Raymundo</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Jung</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Kumar</td>
<td>5.0</td>
<td>NaN</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Maria</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now let’s “modify” the frame with <code>inplace=False</code> with the code below and see what happens:</p>
<div id="dd06bd48" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making change to dataframe with inplace=False</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.dropna(how<span class="op">=</span><span class="st">'any'</span>, inplace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Looking at the dataframe</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Floriana</td>
<td>NaN</td>
<td>5.0</td>
<td>5.0</td>
<td>3.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Raymundo</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Jung</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Kumar</td>
<td>5.0</td>
<td>NaN</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Maria</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Ok, it kind of looks like “nothing happened”! And in a way, with the code we ran, nothing did happen, as the result was not assigned to a new object. Soooo, what’s the point of that? Any guesses?</p>
<p>When we run exactly the same code except with the parameter <code>inplace</code> set to <code>'True'</code>, the dropped data is actually gone!</p>
<div id="91267ab3" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making change to dataframe with inplace=False</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.dropna(how<span class="op">=</span><span class="st">'any'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Looking at the dataframe</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Arthur</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Martina</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Orson</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
<td>5.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>So now if we want to work with the “movie_ratings” object without the columns we just dropped, we would have to go back and rerun the <code>read_csv()</code> function and fetch the original data again! It is therefore important when writing your cleaning code that you use this parameter carefully.</p>
</section>
<section id="filling-in-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="filling-in-missing-data">Filling in missing data</h3>
<p>Sometimes it is the right cleaning decision to <em>fill in</em> missing data with some values.</p>
<p>Take the example of our movie ratings dataframe. The basic way to fill in missing values would you to specify a value to take the place of each missing value. One approach is to calculate and plug in the mean value - which we know to be (3.85) for the entire dataframe:</p>
<div id="d4ada709" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetching the data, yet again, to make sure we start again with the original</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mr <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span> \</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ds-intro-to-python/main/data/movieratings.csv"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> pd.read_csv(mr)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># using fillna and a passing in a constant</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>filled_385 <span class="op">=</span> movie_ratings.fillna(<span class="fl">3.85</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>filled_385.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Floriana</td>
<td>3.85</td>
<td>5.00</td>
<td>5.00</td>
<td>3.00</td>
<td>3.85</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Raymundo</td>
<td>4.00</td>
<td>3.85</td>
<td>3.85</td>
<td>3.85</td>
<td>5.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Jung</td>
<td>5.00</td>
<td>3.85</td>
<td>3.85</td>
<td>5.00</td>
<td>3.85</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Kumar</td>
<td>5.00</td>
<td>3.85</td>
<td>4.00</td>
<td>3.85</td>
<td>4.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Maria</td>
<td>5.00</td>
<td>4.00</td>
<td>5.00</td>
<td>3.85</td>
<td>3.85</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Arthur</td>
<td>2.00</td>
<td>2.00</td>
<td>3.00</td>
<td>3.00</td>
<td>3.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Marcellus</td>
<td>3.85</td>
<td>3.85</td>
<td>4.00</td>
<td>5.00</td>
<td>4.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Martina</td>
<td>5.00</td>
<td>5.00</td>
<td>5.00</td>
<td>5.00</td>
<td>5.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Orson</td>
<td>1.00</td>
<td>1.00</td>
<td>1.00</td>
<td>2.00</td>
<td>5.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Luke</td>
<td>5.00</td>
<td>3.85</td>
<td>3.85</td>
<td>3.85</td>
<td>3.85</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Ok, that’s good. Good, but not great for our use case! Maybe we could avail ourselves to some options within the <code>method=</code> parameter with the parentheses the <code>fillna()</code> function. With a specification of <code>bfill</code> we can fill a NaN value with the preceding valid value in that column. <code>ffill</code> fills with the value after it.</p>
<p>What would that look like for our dataset?</p>
<div id="46d100e7" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>bfilled_mr <span class="op">=</span> movie_ratings.fillna(method<span class="op">=</span><span class="st">'bfill'</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>bfilled_mr.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Floriana</td>
<td>4.0</td>
<td>5.0</td>
<td>5.0</td>
<td>3.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Raymundo</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Jung</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>5.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Kumar</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Maria</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>3.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Arthur</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Marcellus</td>
<td>5.0</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Martina</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Orson</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Luke</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Notice that the bottom row stays NaN when we use bfill. That’s because it can not find a value to backfill with for this row! Using forward fill creates the same issue for the first row. For our use case, admittedly <code>bfill</code> and <code>ffill</code> probably are sub-optimal solutions.</p>
<p>Since we have some ratings data already for each movie, one approach would be to fill in the missing data with the mean rating for that movie from the valid data.</p>
<p>Let’s try that approach on a single column. For the movie Parasite, we fill in the missing values for that column with the average value:</p>
<div id="441e6ad7" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>movie_ratings[<span class="st">'Parasite'</span>] <span class="op">=</span> movie_ratings[<span class="st">'Parasite'</span>]. <span class="op">\</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  fillna(movie_ratings[<span class="st">'Parasite'</span>].mean())</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>movie_ratings.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Floriana</td>
<td>NaN</td>
<td>5.0</td>
<td>5.0</td>
<td>3.000000</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Raymundo</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>3.833333</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Jung</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.000000</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Kumar</td>
<td>5.0</td>
<td>NaN</td>
<td>4.0</td>
<td>3.833333</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Maria</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>3.833333</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Arthur</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.000000</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Marcellus</td>
<td>NaN</td>
<td>NaN</td>
<td>4.0</td>
<td>5.000000</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Martina</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Orson</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.000000</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Luke</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>3.833333</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>And we can extend that for all numeric columns at once!</p>
<div id="5688ba0d" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> movie_ratings.fillna(movie_ratings.mean(numeric_only<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rater</th>
<th data-quarto-table-cell-role="th">Star Wars</th>
<th data-quarto-table-cell-role="th">Finding Nemo</th>
<th data-quarto-table-cell-role="th">Forrest Gump</th>
<th data-quarto-table-cell-role="th">Parasite</th>
<th data-quarto-table-cell-role="th">Citizen Kane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Floriana</td>
<td>4.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>3.000000</td>
<td>4.333333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Raymundo</td>
<td>4.0</td>
<td>3.4</td>
<td>3.857143</td>
<td>3.833333</td>
<td>5.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Jung</td>
<td>5.0</td>
<td>3.4</td>
<td>3.857143</td>
<td>5.000000</td>
<td>4.333333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Kumar</td>
<td>5.0</td>
<td>3.4</td>
<td>4.000000</td>
<td>3.833333</td>
<td>4.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Maria</td>
<td>5.0</td>
<td>4.0</td>
<td>5.000000</td>
<td>3.833333</td>
<td>4.333333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Arthur</td>
<td>2.0</td>
<td>2.0</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Marcellus</td>
<td>4.0</td>
<td>3.4</td>
<td>4.000000</td>
<td>5.000000</td>
<td>4.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Martina</td>
<td>5.0</td>
<td>5.0</td>
<td>5.000000</td>
<td>5.000000</td>
<td>5.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Orson</td>
<td>1.0</td>
<td>1.0</td>
<td>1.000000</td>
<td>2.000000</td>
<td>5.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Luke</td>
<td>5.0</td>
<td>3.4</td>
<td>3.857143</td>
<td>3.833333</td>
<td>4.333333</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>While far from perfect, now we have some filled in data that has some reasonable chance of adding value.</p>
<p>Similar to <code>fillna()</code> is a method called <code>interpolate()</code>, which takes the average of the values near the missing values and plugs them in. To do this, we pass in the <code>interpolate()</code> in similar fashion to how we used <code>fillna()</code> above.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Challenge 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>You are given a dataset for several days time frame in April/May 2021 of the average daily temperature in celcius for three Canadian cities. You would like to ultimately create a plot of the temperatures but don’t want to have gaps in the data. Run the code below to get the data and see what it looks like.</p>
<div id="5858ceee" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>temps <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span> \</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ds-intro-to-python/main/data/citytemps.csv"</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>city_temps <span class="op">=</span> pd.read_csv(temps)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>city_temps.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Day</th>
<th data-quarto-table-cell-role="th">Victoria</th>
<th data-quarto-table-cell-role="th">Regina</th>
<th data-quarto-table-cell-role="th">Sudbury</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25-Feb-21</td>
<td>15.0</td>
<td>NaN</td>
<td>7.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>26-Feb-21</td>
<td>18.0</td>
<td>-11.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>27-Feb-21</td>
<td>NaN</td>
<td>-6.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>28-Feb-21</td>
<td>12.0</td>
<td>-2.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>01-Mar-21</td>
<td>NaN</td>
<td>NaN</td>
<td>7.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>02-Mar-21</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>03-Mar-21</td>
<td>NaN</td>
<td>NaN</td>
<td>14.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>04-Mar-21</td>
<td>15.0</td>
<td>7.0</td>
<td>11.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>05-Mar-21</td>
<td>13.0</td>
<td>NaN</td>
<td>9.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>06-Mar-21</td>
<td>11.0</td>
<td>4.0</td>
<td>14.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Unfortunately you notice that several of the days have data missing. Write code that leverages the interpolate() function to fill in the missing data. Run the code. Is this an appropriate solution for the problem? What are the pros and cons to this approach.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution to Challenge 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Code you would write is below.</p>
<div id="ba6166b2" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>interpolate_temps <span class="op">=</span> city_temps.interpolate()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>interpolate_temps.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Day</th>
<th data-quarto-table-cell-role="th">Victoria</th>
<th data-quarto-table-cell-role="th">Regina</th>
<th data-quarto-table-cell-role="th">Sudbury</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25-Feb-21</td>
<td>15.00</td>
<td>NaN</td>
<td>7.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>26-Feb-21</td>
<td>18.00</td>
<td>-11.00</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>27-Feb-21</td>
<td>15.00</td>
<td>-6.00</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>28-Feb-21</td>
<td>12.00</td>
<td>-2.00</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>01-Mar-21</td>
<td>12.75</td>
<td>0.25</td>
<td>7.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>02-Mar-21</td>
<td>13.50</td>
<td>2.50</td>
<td>10.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>03-Mar-21</td>
<td>14.25</td>
<td>4.75</td>
<td>14.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>04-Mar-21</td>
<td>15.00</td>
<td>7.00</td>
<td>11.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>05-Mar-21</td>
<td>13.00</td>
<td>5.50</td>
<td>9.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>06-Mar-21</td>
<td>11.00</td>
<td>4.00</td>
<td>14.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here we can see how the values “smooth” out the data. Were we to go ahead and plot the data, it would make more sense.</p>
</div>
</div>
</div>
<p>Dealing with missing data is one normal task in cleaning, changing data and header content is another, let’s take a look at that next.</p>
</section>
</section>
<section id="modifying-existing-data" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="modifying-existing-data"><span class="header-section-number">5.3</span> Modifying existing data</h2>
<p>Now let’s grad a different dataset, this one is quite redacted snip of the 2014 Mental Health in Tech Survey https://www.kaggle.com/datasets/osmi/mental-health-in-tech-survey.</p>
<div id="cc57c56e" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>techhealth <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/bcgov/"</span> \</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ds-intro-to-python/main/data/techhealth.csv"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>m_health <span class="op">=</span> pd.read_csv(techhealth)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>m_health.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Timestamp</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Gender</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">self employed</th>
<th data-quarto-table-cell-role="th">family history</th>
<th data-quarto-table-cell-role="th">treatment</th>
<th data-quarto-table-cell-role="th">work interfere</th>
<th data-quarto-table-cell-role="th">remote work</th>
<th data-quarto-table-cell-role="th">tech company</th>
<th data-quarto-table-cell-role="th">benefits</th>
<th data-quarto-table-cell-role="th">leave</th>
<th data-quarto-table-cell-role="th">mental health consequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>27/08/2014 11:35</td>
<td>46</td>
<td>Male</td>
<td>United States</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Often</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Don't know</td>
<td>Maybe</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>27/08/2014 11:36</td>
<td>41</td>
<td>Male</td>
<td>United States</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Never</td>
<td>No</td>
<td>No</td>
<td>Don't know</td>
<td>Don't know</td>
<td>Maybe</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>27/08/2014 11:36</td>
<td>33</td>
<td>male</td>
<td>United States</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Rarely</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Don't know</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>27/08/2014 11:37</td>
<td>35</td>
<td>male</td>
<td>United States</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Sometimes</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Very easy</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>27/08/2014 11:42</td>
<td>35</td>
<td>M</td>
<td>United States</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Rarely</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Very easy</td>
<td>No</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><br> This abridged version of the dataset contains 24 cases and 13 variables:</p>
<ul>
<li>Timestamp</li>
<li>Age</li>
<li>Gender</li>
<li>Country</li>
<li>Self Employed: Are you self-employed?</li>
<li>Family History: Do you have a family history of mental illness?</li>
<li>Treatment: Have you sought treatment for a mental health condition?</li>
<li>Work Interfere: If you have a mental health condition, do you feel that it interferes with your work?</li>
<li>Remote Work: Do you work remotely (outside of an office) at least 50% of the time?</li>
<li>Tech Company: Is your employer primarily a tech company/organization?</li>
<li>Benefits: Does your employer provide mental health benefits?</li>
<li>Leave: How easy is it for you to take medical leave for a mental health condition?</li>
<li>Mental Health Consequence: Do you think that discussing a mental health issue with your employer would have negative consequences?</li>
</ul>
<section id="cleaning-the-header-row" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-the-header-row">Cleaning the header row</h3>
<p>A good practice, both in terms of ensuring a consistent convention for column names and for the ability to write more efficient code, is to ensure that all column header names do not have spaces in them and are all in lower case. To do this with our current dataset, we use the <code>str.replace()</code> function on all the header row, identified in pandas via .columns:</p>
<div id="431a4c78" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>m_health.columns <span class="op">=</span> m_health.columns.<span class="bu">str</span>.replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>m_health.columns <span class="op">=</span> m_health.columns.<span class="bu">str</span>.lower()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>m_health.head(<span class="dv">10</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>m_health.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 24 entries, 0 to 23
Data columns (total 13 columns):
 #   Column                     Non-Null Count  Dtype 
---  ------                     --------------  ----- 
 0   timestamp                  24 non-null     object
 1   age                        24 non-null     int64 
 2   gender                     24 non-null     object
 3   country                    24 non-null     object
 4   self_employed              24 non-null     object
 5   family_history             24 non-null     object
 6   treatment                  24 non-null     object
 7   work_interfere             24 non-null     object
 8   remote_work                24 non-null     object
 9   tech_company               24 non-null     object
 10  benefits                   24 non-null     object
 11  leave                      24 non-null     object
 12  mental_health_consequence  24 non-null     object
dtypes: int64(1), object(12)
memory usage: 2.6+ KB</code></pre>
</div>
</div>
<p>The other thing to notice that there are no missing values! So we can just concentrate on other cleaning tasks.</p>
</section>
<section id="ensuring-the-right-datatypes" class="level3">
<h3 class="anchored" data-anchor-id="ensuring-the-right-datatypes">Ensuring the right datatypes</h3>
<p>A good practice is to notice whether there are series in the dataframe that are improperly datatyped (that is, where the “Dtype” indicated does not correspond to the datatype that it should be).</p>
<p>Taking a look at the data, we notice that “Timestamp” is datatyped as an “object”, which in this context means a “string”. However, that is sub-optimal because the content is time-oriented, and by coding it as an object/string, we limit a lot of its value. If we identify datatype as a time oriented one, that can give us advantages downstream in being able to work with the data more elegantly.</p>
<p>Pandas has functions specifically designed to cast datatypes from one to another, as was covered in the previous section with the <code>astype()</code> function.</p>
<p>To cast a variable as a datetime datatype, we can use the pandas <code>to_datetime()</code> function and pass in the pandas series you want to modify:</p>
<div id="c5e9754f" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'timestamp'</span>] <span class="op">=</span> pd.to_datetime(m_health[<span class="st">'timestamp'</span>])</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>m_health.head()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>m_health.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 24 entries, 0 to 23
Data columns (total 13 columns):
 #   Column                     Non-Null Count  Dtype         
---  ------                     --------------  -----         
 0   timestamp                  24 non-null     datetime64[ns]
 1   age                        24 non-null     int64         
 2   gender                     24 non-null     object        
 3   country                    24 non-null     object        
 4   self_employed              24 non-null     object        
 5   family_history             24 non-null     object        
 6   treatment                  24 non-null     object        
 7   work_interfere             24 non-null     object        
 8   remote_work                24 non-null     object        
 9   tech_company               24 non-null     object        
 10  benefits                   24 non-null     object        
 11  leave                      24 non-null     object        
 12  mental_health_consequence  24 non-null     object        
dtypes: datetime64[ns](1), int64(1), object(11)
memory usage: 2.6+ KB</code></pre>
</div>
</div>
<p>Et voila - timestamp is now of the datatime64 datatype! Were we wanting to leverage timestamp’s date time qualities, we could now do so more easily. It should be added, that this example works well because the existing data is nicely formatted to be understood as data/time datatype data. In the real world, if the timestamp column has different date types, or isn’t actually a date column at all, the method raises exceptions that you will have to work through. For example, look at what happens if we try to force a different variable into a data/time data type:</p>
<div id="d8596d54" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'tech_company'</span>] <span class="op">=</span> pd.to_datetime(m_health[<span class="st">'tech_company'</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>m_health.head()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>m_health.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/core/arrays/datetimes.py:2236</span>, in <span class="ansi-cyan-fg">objects_to_datetime64ns</span><span class="ansi-blue-fg">(data, dayfirst, yearfirst, utc, errors, require_iso8601, allow_object, allow_mixed)</span>
<span class="ansi-green-fg ansi-bold">   2235</span> <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 2236</span>     values, tz_parsed <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">conversion</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">datetime_to_datetime64</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">ravel</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">K</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">   2237</span>     <span style="font-style:italic;color:rgb(95,135,135)"># If tzaware, these values represent unix timestamps, so we</span>
<span class="ansi-green-fg ansi-bold">   2238</span>     <span style="font-style:italic;color:rgb(95,135,135)">#  return them as i8 to distinguish from wall times</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/_libs/tslibs/conversion.pyx:360</span>, in <span class="ansi-cyan-fg">pandas._libs.tslibs.conversion.datetime_to_datetime64</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">TypeError</span>: Unrecognized value type: &lt;class 'str'&gt;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">ParserError</span>                               Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[20], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> m_health[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">tech_company</span><span style="color:rgb(175,0,0)">'</span>] <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">pd</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">to_datetime</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">m_health</span><span class="ansi-yellow-bg">[</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">'</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">tech_company</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">'</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      2</span> m_health<span style="color:rgb(98,98,98)">.</span>head()
<span class="ansi-green-fg ansi-bold">      3</span> m_health<span style="color:rgb(98,98,98)">.</span>info()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/core/tools/datetimes.py:1051</span>, in <span class="ansi-cyan-fg">to_datetime</span><span class="ansi-blue-fg">(arg, errors, dayfirst, yearfirst, utc, format, exact, unit, infer_datetime_format, origin, cache)</span>
<span class="ansi-green-fg ansi-bold">   1049</span>         result <span style="color:rgb(98,98,98)">=</span> arg<span style="color:rgb(98,98,98)">.</span>map(cache_array)
<span class="ansi-green-fg ansi-bold">   1050</span>     <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1051</span>         values <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">convert_listlike</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">arg</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_values</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">format</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">   1052</span>         result <span style="color:rgb(98,98,98)">=</span> arg<span style="color:rgb(98,98,98)">.</span>_constructor(values, index<span style="color:rgb(98,98,98)">=</span>arg<span style="color:rgb(98,98,98)">.</span>index, name<span style="color:rgb(98,98,98)">=</span>arg<span style="color:rgb(98,98,98)">.</span>name)
<span class="ansi-green-fg ansi-bold">   1053</span> <span style="font-weight:bold;color:rgb(0,135,0)">elif</span> <span style="color:rgb(0,135,0)">isinstance</span>(arg, (ABCDataFrame, abc<span style="color:rgb(98,98,98)">.</span>MutableMapping)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/core/tools/datetimes.py:402</span>, in <span class="ansi-cyan-fg">_convert_listlike_datetimes</span><span class="ansi-blue-fg">(arg, format, name, tz, unit, errors, infer_datetime_format, dayfirst, yearfirst, exact)</span>
<span class="ansi-green-fg ansi-bold">    400</span> <span style="font-weight:bold;color:rgb(0,135,0)">assert</span> <span style="color:rgb(0,135,0)">format</span> <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span> <span style="font-weight:bold;color:rgb(175,0,255)">or</span> infer_datetime_format
<span class="ansi-green-fg ansi-bold">    401</span> utc <span style="color:rgb(98,98,98)">=</span> tz <span style="color:rgb(98,98,98)">==</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">utc</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg">--&gt; 402</span> result, tz_parsed <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">objects_to_datetime64ns</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    403</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">arg</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    404</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">dayfirst</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">dayfirst</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    405</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">yearfirst</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">yearfirst</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    406</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">utc</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">utc</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    407</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">errors</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">errors</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    408</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">require_iso8601</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">require_iso8601</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    409</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">allow_object</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="font-weight:bold;color:rgb(0,135,0)" class="ansi-yellow-bg">True</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    410</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    412</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> tz_parsed <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg ansi-bold">    413</span>     <span style="font-style:italic;color:rgb(95,135,135)"># We can take a shortcut since the datetime64 numpy array</span>
<span class="ansi-green-fg ansi-bold">    414</span>     <span style="font-style:italic;color:rgb(95,135,135)"># is in UTC</span>
<span class="ansi-green-fg ansi-bold">    415</span>     dta <span style="color:rgb(98,98,98)">=</span> DatetimeArray(result, dtype<span style="color:rgb(98,98,98)">=</span>tz_to_dtype(tz_parsed))

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/core/arrays/datetimes.py:2242</span>, in <span class="ansi-cyan-fg">objects_to_datetime64ns</span><span class="ansi-blue-fg">(data, dayfirst, yearfirst, utc, errors, require_iso8601, allow_object, allow_mixed)</span>
<span class="ansi-green-fg ansi-bold">   2240</span>         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> values<span style="color:rgb(98,98,98)">.</span>view(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">i8</span><span style="color:rgb(175,0,0)">"</span>), tz_parsed
<span class="ansi-green-fg ansi-bold">   2241</span>     <span style="font-weight:bold;color:rgb(0,135,0)">except</span> (<span style="font-weight:bold;color:rgb(215,95,95)">ValueError</span>, <span style="font-weight:bold;color:rgb(215,95,95)">TypeError</span>):
<span class="ansi-green-fg">-&gt; 2242</span>         <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> err
<span class="ansi-green-fg ansi-bold">   2244</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> tz_parsed <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg ansi-bold">   2245</span>     <span style="font-style:italic;color:rgb(95,135,135)"># We can take a shortcut since the datetime64 numpy array</span>
<span class="ansi-green-fg ansi-bold">   2246</span>     <span style="font-style:italic;color:rgb(95,135,135)">#  is in UTC</span>
<span class="ansi-green-fg ansi-bold">   2247</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Return i8 values to denote unix timestamps</span>
<span class="ansi-green-fg ansi-bold">   2248</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> result<span style="color:rgb(98,98,98)">.</span>view(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">i8</span><span style="color:rgb(175,0,0)">"</span>), tz_parsed

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/core/arrays/datetimes.py:2224</span>, in <span class="ansi-cyan-fg">objects_to_datetime64ns</span><span class="ansi-blue-fg">(data, dayfirst, yearfirst, utc, errors, require_iso8601, allow_object, allow_mixed)</span>
<span class="ansi-green-fg ansi-bold">   2222</span> order: Literal[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">F</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">C</span><span style="color:rgb(175,0,0)">"</span>] <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">F</span><span style="color:rgb(175,0,0)">"</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> flags<span style="color:rgb(98,98,98)">.</span>f_contiguous <span style="font-weight:bold;color:rgb(0,135,0)">else</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">C</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">   2223</span> <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 2224</span>     result, tz_parsed <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">tslib</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">array_to_datetime</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">   2225</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">data</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">ravel</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">K</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">   2226</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">errors</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">errors</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">   2227</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">utc</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">utc</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">   2228</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">dayfirst</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">dayfirst</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">   2229</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">yearfirst</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">yearfirst</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">   2230</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">require_iso8601</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">require_iso8601</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">   2231</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">allow_mixed</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">allow_mixed</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">   2232</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">   2233</span>     result <span style="color:rgb(98,98,98)">=</span> result<span style="color:rgb(98,98,98)">.</span>reshape(data<span style="color:rgb(98,98,98)">.</span>shape, order<span style="color:rgb(98,98,98)">=</span>order)
<span class="ansi-green-fg ansi-bold">   2234</span> <span style="font-weight:bold;color:rgb(0,135,0)">except</span> <span style="font-weight:bold;color:rgb(215,95,95)">ValueError</span> <span style="font-weight:bold;color:rgb(0,135,0)">as</span> err:

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/_libs/tslib.pyx:381</span>, in <span class="ansi-cyan-fg">pandas._libs.tslib.array_to_datetime</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/_libs/tslib.pyx:613</span>, in <span class="ansi-cyan-fg">pandas._libs.tslib.array_to_datetime</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/_libs/tslib.pyx:751</span>, in <span class="ansi-cyan-fg">pandas._libs.tslib._array_to_datetime_object</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/_libs/tslib.pyx:742</span>, in <span class="ansi-cyan-fg">pandas._libs.tslib._array_to_datetime_object</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/pandas/_libs/tslibs/parsing.pyx:281</span>, in <span class="ansi-cyan-fg">pandas._libs.tslibs.parsing.parse_datetime_string</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/dateutil/parser/_parser.py:1368</span>, in <span class="ansi-cyan-fg">parse</span><span class="ansi-blue-fg">(timestr, parserinfo, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">   1366</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> parser(parserinfo)<span style="color:rgb(98,98,98)">.</span>parse(timestr, <span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg ansi-bold">   1367</span> <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1368</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">DEFAULTPARSER</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">parse</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">timestr</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.20/x64/lib/python3.9/site-packages/dateutil/parser/_parser.py:643</span>, in <span class="ansi-cyan-fg">parser.parse</span><span class="ansi-blue-fg">(self, timestr, default, ignoretz, tzinfos, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">    640</span> res, skipped_tokens <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_parse(timestr, <span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg ansi-bold">    642</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> res <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">--&gt; 643</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> ParserError(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Unknown string format: </span><span style="font-weight:bold;color:rgb(175,95,135)">%s</span><span style="color:rgb(175,0,0)">"</span>, timestr)
<span class="ansi-green-fg ansi-bold">    645</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">len</span>(res) <span style="color:rgb(98,98,98)">==</span> <span style="color:rgb(98,98,98)">0</span>:
<span class="ansi-green-fg ansi-bold">    646</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> ParserError(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">String does not contain a date: </span><span style="font-weight:bold;color:rgb(175,95,135)">%s</span><span style="color:rgb(175,0,0)">"</span>, timestr)

<span class="ansi-red-fg">ParserError</span>: Unknown string format: Yes</pre>
</div>
</div>
</div>
<p>The error let’s us know that this data typing conversion will not work as coded.</p>
</section>
<section id="recoding-values" class="level3">
<h3 class="anchored" data-anchor-id="recoding-values">Recoding values</h3>
<p>Value recoding is a data cleaning task to put the column values into more manageable categories. This is a common data recoding task that most data analyst type folks will be familiar with. Pandas alone has many functions that solve recoding issues in different ways. We will just highlight a few in this tutorial.</p>
<p>With this dataset we’ve called there are a few columns that we would like to make changes to so that it will be easier to analyze the data in the way we want. The <code>value_counts()</code> method shows the range of responses and their frequency in the dataframe.</p>
<div id="10281fac" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'gender'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>Male        12
male         6
M            2
Female       1
m            1
F            1
Cis Male     1
Name: gender, dtype: int64</code></pre>
</div>
</div>
<p>With that knowledge, we can utilize the <code>replace()</code> function and pass in custom lists with all of the responses that should be replaced by a single specfied value.</p>
<div id="3208f364" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'gender'</span>].replace([<span class="st">'Male '</span>, <span class="st">'male'</span>, <span class="st">'M'</span>, <span class="st">'m'</span>, <span class="st">'Male'</span>, <span class="st">'Cis Male'</span>],</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Male'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'gender'</span>].replace([<span class="st">'Female '</span>, <span class="st">'female'</span>, <span class="st">'F'</span>],</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Female'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'gender'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>Male      22
Female     2
Name: gender, dtype: int64</code></pre>
</div>
</div>
<p>Another task is to put categorical objects into a form that is more amenable to computational tasks. Let’s take a look at a categorial variable that consists of responses of “Yes” and “No”.</p>
<div id="a2b32bfa" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'self_employed'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>No     23
Yes     1
Name: self_employed, dtype: int64</code></pre>
</div>
</div>
<p>If we want to leverage this data purely as a segment to split other metrics with, we would probably leave as is. But perhaps we would like to treat it as a dummy variable so we can do more sophisticated math with it.</p>
<p>For our self-employed variable, we begin by implementing <code>replace()</code> to transform the existing content to numbers as shown below:</p>
<div id="51eca441" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'self_employed'</span>].replace([<span class="st">'Yes'</span>], <span class="st">'1'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'self_employed'</span>].replace([<span class="st">'No'</span>], <span class="st">'0'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'self_employed'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>0    23
1     1
Name: self_employed, dtype: int64</code></pre>
</div>
</div>
<p>The pandas <code>astype()</code> function is able to interpret the 1s and 0s as integers and so we can transform the series into an <code>int</code> datatype.</p>
<div id="0d39aa46" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'self_employed'</span>] <span class="op">=</span> m_health[<span class="st">'self_employed'</span>] <span class="op">\</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>        .astype(dtype<span class="op">=</span><span class="st">'int'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>m_health.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">self_employed</th>
<th data-quarto-table-cell-role="th">family_history</th>
<th data-quarto-table-cell-role="th">treatment</th>
<th data-quarto-table-cell-role="th">work_interfere</th>
<th data-quarto-table-cell-role="th">remote_work</th>
<th data-quarto-table-cell-role="th">tech_company</th>
<th data-quarto-table-cell-role="th">benefits</th>
<th data-quarto-table-cell-role="th">leave</th>
<th data-quarto-table-cell-role="th">mental_health_consequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014-08-27 11:35:00</td>
<td>46</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>Often</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Don't know</td>
<td>Maybe</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014-08-27 11:36:00</td>
<td>41</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>Never</td>
<td>No</td>
<td>No</td>
<td>Don't know</td>
<td>Don't know</td>
<td>Maybe</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014-08-27 11:36:00</td>
<td>33</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>Yes</td>
<td>Yes</td>
<td>Rarely</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Don't know</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2014-08-27 11:37:00</td>
<td>35</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>Yes</td>
<td>Yes</td>
<td>Sometimes</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Very easy</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2014-08-27 11:42:00</td>
<td>35</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>Rarely</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Very easy</td>
<td>No</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now we see that variable as a series of int-typed 0s and 1s. <br></p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Challenge 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>You would like to clean up the scale used in the question about whether one’s mental illness affects one’s work.</p>
<ol type="1">
<li><p>Find the column (pandas series) that needs to be transformed and transform its values using <code>replace()</code> with numerical values that make sense.</p></li>
<li><p>Display the modified dataframe showing the replaced values.</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution to Challenge 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>First, find the distribution of cases per value label:</p>
<div id="b7df3ef8" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>Sometimes    12
Never         5
Rarely        4
Often         3
Name: work_interfere, dtype: int64</code></pre>
</div>
</div>
<p>Then show how to use replace to transform the scale into a numeric one:</p>
<div id="6e2089f8" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].replace([<span class="st">'Never'</span>], <span class="st">'0'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].replace([<span class="st">'Rarely'</span>], <span class="st">'1'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].replace([<span class="st">'Sometimes'</span>], <span class="st">'2'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].replace([<span class="st">'Often'</span>], <span class="st">'3'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>2    12
0     5
1     4
3     3
Name: work_interfere, dtype: int64</code></pre>
</div>
</div>
<p>Distribution of values looks good. Let’s take a look at the datatypes for the dataframe object.</p>
<div id="7bc818ad" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>m_health.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 24 entries, 0 to 23
Data columns (total 13 columns):
 #   Column                     Non-Null Count  Dtype         
---  ------                     --------------  -----         
 0   timestamp                  24 non-null     datetime64[ns]
 1   age                        24 non-null     int64         
 2   gender                     24 non-null     object        
 3   country                    24 non-null     object        
 4   self_employed              24 non-null     int64         
 5   family_history             24 non-null     object        
 6   treatment                  24 non-null     object        
 7   work_interfere             24 non-null     object        
 8   remote_work                24 non-null     object        
 9   tech_company               24 non-null     object        
 10  benefits                   24 non-null     object        
 11  leave                      24 non-null     object        
 12  mental_health_consequence  24 non-null     object        
dtypes: datetime64[ns](1), int64(2), object(10)
memory usage: 2.6+ KB</code></pre>
</div>
</div>
<p>But it is still typed as an object. So change datatype to int.</p>
<div id="19621c9e" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>m_health[<span class="st">'work_interfere'</span>] <span class="op">=</span> m_health[<span class="st">'work_interfere'</span>] <span class="op">\</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>        .astype(dtype<span class="op">=</span><span class="st">'int'</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>m_health.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 24 entries, 0 to 23
Data columns (total 13 columns):
 #   Column                     Non-Null Count  Dtype         
---  ------                     --------------  -----         
 0   timestamp                  24 non-null     datetime64[ns]
 1   age                        24 non-null     int64         
 2   gender                     24 non-null     object        
 3   country                    24 non-null     object        
 4   self_employed              24 non-null     int64         
 5   family_history             24 non-null     object        
 6   treatment                  24 non-null     object        
 7   work_interfere             24 non-null     int64         
 8   remote_work                24 non-null     object        
 9   tech_company               24 non-null     object        
 10  benefits                   24 non-null     object        
 11  leave                      24 non-null     object        
 12  mental_health_consequence  24 non-null     object        
dtypes: datetime64[ns](1), int64(3), object(9)
memory usage: 2.6+ KB</code></pre>
</div>
</div>
<p>Finally, show the dataframe itself.</p>
<div id="0854452f" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>m_health</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">self_employed</th>
<th data-quarto-table-cell-role="th">family_history</th>
<th data-quarto-table-cell-role="th">treatment</th>
<th data-quarto-table-cell-role="th">work_interfere</th>
<th data-quarto-table-cell-role="th">remote_work</th>
<th data-quarto-table-cell-role="th">tech_company</th>
<th data-quarto-table-cell-role="th">benefits</th>
<th data-quarto-table-cell-role="th">leave</th>
<th data-quarto-table-cell-role="th">mental_health_consequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014-08-27 11:35:00</td>
<td>46</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>3</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Don't know</td>
<td>Maybe</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014-08-27 11:36:00</td>
<td>41</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>0</td>
<td>No</td>
<td>No</td>
<td>Don't know</td>
<td>Don't know</td>
<td>Maybe</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014-08-27 11:36:00</td>
<td>33</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>Yes</td>
<td>Yes</td>
<td>1</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Don't know</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2014-08-27 11:37:00</td>
<td>35</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>Yes</td>
<td>Yes</td>
<td>2</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Very easy</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2014-08-27 11:42:00</td>
<td>35</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>1</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Very easy</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2014-08-27 11:42:00</td>
<td>24</td>
<td>Male</td>
<td>United Kingdom</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>2</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
<td>Don't know</td>
<td>Maybe</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014-08-27 11:42:00</td>
<td>35</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>No</td>
<td>2</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Somewhat difficult</td>
<td>Yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2014-08-27 11:43:00</td>
<td>27</td>
<td>Male</td>
<td>Canada</td>
<td>0</td>
<td>Yes</td>
<td>Yes</td>
<td>2</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
<td>Very difficult</td>
<td>Maybe</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2014-08-27 11:43:00</td>
<td>18</td>
<td>Male</td>
<td>Netherlands</td>
<td>0</td>
<td>No</td>
<td>No</td>
<td>3</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
<td>Somewhat difficult</td>
<td>Yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2014-08-27 11:43:00</td>
<td>30</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>2</td>
<td>No</td>
<td>Yes</td>
<td>Don't know</td>
<td>Don't know</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2014-08-27 11:43:00</td>
<td>38</td>
<td>Female</td>
<td>United States</td>
<td>0</td>
<td>Yes</td>
<td>Yes</td>
<td>2</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Somewhat easy</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2014-08-27 11:43:00</td>
<td>28</td>
<td>Male</td>
<td>United Kingdom</td>
<td>0</td>
<td>No</td>
<td>No</td>
<td>2</td>
<td>No</td>
<td>Yes</td>
<td>Don't know</td>
<td>Don't know</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2014-08-27 11:43:00</td>
<td>34</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>No</td>
<td>2</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
<td>Don't know</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>2014-08-27 11:43:00</td>
<td>26</td>
<td>Male</td>
<td>Canada</td>
<td>1</td>
<td>No</td>
<td>No</td>
<td>2</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
<td>Don't know</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>2014-08-27 11:44:00</td>
<td>30</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>Yes</td>
<td>Yes</td>
<td>1</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Don't know</td>
<td>Maybe</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>2014-08-27 12:12:00</td>
<td>31</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>No</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Somewhat easy</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>2014-08-27 12:13:00</td>
<td>40</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
<td>Very difficult</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>2014-08-27 12:14:00</td>
<td>34</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>No</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>Don't know</td>
<td>Somewhat easy</td>
<td>Maybe</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>2014-08-27 12:15:00</td>
<td>25</td>
<td>Female</td>
<td>Canada</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>2</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Don't know</td>
<td>Maybe</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>2014-08-27 12:15:00</td>
<td>29</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>No</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>Don't know</td>
<td>Don't know</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>2014-08-27 12:16:00</td>
<td>24</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>Yes</td>
<td>No</td>
<td>1</td>
<td>No</td>
<td>Yes</td>
<td>Don't know</td>
<td>Somewhat easy</td>
<td>Maybe</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>2014-08-27 12:17:00</td>
<td>31</td>
<td>Male</td>
<td>Mexico</td>
<td>0</td>
<td>Yes</td>
<td>Yes</td>
<td>2</td>
<td>No</td>
<td>Yes</td>
<td>Don't know</td>
<td>Don't know</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>2014-08-27 12:18:00</td>
<td>33</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>2</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
<td>Somewhat easy</td>
<td>Maybe</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>2014-08-27 12:18:00</td>
<td>30</td>
<td>Male</td>
<td>United States</td>
<td>0</td>
<td>No</td>
<td>Yes</td>
<td>3</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
<td>Somewhat easy</td>
<td>No</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./11_getting_data_with_pandas.html" class="pagination-link" aria-label="Getting Data With Pandas">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Getting Data With Pandas</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./21_exploring_data_structures.html" class="pagination-link" aria-label="Exploring Data Structures">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Exploring Data Structures</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Introduction to Data Science using Python was written by <br> Lindsay Forestell and Stuart Hemerling</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="./license.html">
<p>License</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="./index.html">
<p>Python for Data Science Course</p>
</a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/bcgov/ds-intro-to-python/blob/main/12_cleaning_it_up.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/bcgov/ds-intro-to-python/edit/main/12_cleaning_it_up.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/bcgov/ds-intro-to-python/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>